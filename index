<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø§Ù„ÙØ§Ø®Ø± - Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: radial-gradient(circle at center, #0a0a0a 0%, #000000 100%);
            color: #fff;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: 20px;
            perspective: 1200px;
            overflow-x: hidden;
        }

        /* Ø£Ù†Ù…Ø§Ø· ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø© */
        body.power-save-mode {
            background: #0c0c0c;
            perspective: none;
        }

        body.power-save-mode .stars-background,
        body.power-save-mode .light-effects,
        body.power-save-mode .light-effect,
        body.power-save-mode .shadow-layer,
        body.power-save-mode .gold-glow,
        body.power-save-mode .player-glow {
            display: none !important;
        }

        body.power-save-mode .music-player {
            background: linear-gradient(145deg, #0c0c0c, #1a1a1a);
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.5),
                0 0 5px rgba(0, 80, 0, 0.3);
            border: 1px solid rgba(139, 128, 0, 0.3);
        }

        body.power-save-mode .player-header {
            background: linear-gradient(135deg, #0d3b0d 0%, #1a4d1a 100%);
            box-shadow: 0 3px 10px rgba(0, 80, 0, 0.3);
        }

        body.power-save-mode .album-art-container {
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.4), 
                0 0 10px rgba(0, 80, 0, 0.3);
        }

        body.power-save-mode .visualizer-container,
        body.power-save-mode .bass-indicator,
        body.power-save-mode .spectrum-display {
            display: none !important;
        }

        body.power-save-mode .advanced-controls {
            background: rgba(15, 15, 15, 0.95);
        }

        body.power-save-mode .control-btn {
            box-shadow: 
                0 3px 8px rgba(0, 0, 0, 0.3),
                0 0 3px rgba(139, 128, 0, 0.2);
        }

        body.power-save-mode .play-pause {
            box-shadow: 
                0 5px 12px rgba(0, 0, 0, 0.4), 
                0 0 10px rgba(0, 80, 0, 0.3);
        }

        body.power-save-mode .power-save-btn {
            background: linear-gradient(135deg, #0d3b0d, #1a4d1a);
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.5);
            color: #d4af37;
        }

        .power-save-btn {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: none;
            color: #e0e0e0;
            padding: 12px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.3);
            z-index: 20;
            border: 1px solid rgba(255, 215, 0, 0.2);
            font-weight: 600;
        }

        .power-save-btn:hover {
            background: linear-gradient(145deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.5);
            color: #FFD700;
            transform: translateX(-50%) translateY(-2px);
        }

        /* Ø¨Ù‚ÙŠØ© Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ù…ÙˆØ¬ÙˆØ¯Ø© ÙÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ */
        .stars-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -2;
        }

        .star {
            position: absolute;
            background-color: white;
            border-radius: 50%;
            animation: twinkle 4s infinite ease-in-out;
        }

        @keyframes twinkle {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        .light-effects {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1;
            pointer-events: none;
        }

        .light-spot {
            position: absolute;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,215,0,0.15) 0%, transparent 70%);
            filter: blur(40px);
            animation: pulseLight 8s infinite alternate;
        }

        .light-spot:nth-child(1) {
            width: 300px;
            height: 300px;
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .light-spot:nth-child(2) {
            width: 400px;
            height: 400px;
            bottom: 5%;
            right: 5%;
            background: radial-gradient(circle, rgba(0,100,0,0.2) 0%, transparent 70%);
            animation-delay: 2s;
        }

        .light-spot:nth-child(3) {
            width: 250px;
            height: 250px;
            top: 50%;
            left: 70%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation-delay: 4s;
        }

        @keyframes pulseLight {
            0% { opacity: 0.3; transform: scale(1); }
            100% { opacity: 0.7; transform: scale(1.2); }
        }

        .main-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
            transform-style: preserve-3d;
        }

        .player-section {
            flex: 1;
            min-width: 500px;
            position: relative;
            transform-style: preserve-3d;
            transition: transform 1s ease;
        }

        .music-player {
            width: 100%;
            background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
            border-radius: 25px;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.8),
                0 0 30px rgba(0, 100, 0, 0.4),
                0 0 60px rgba(255, 215, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            overflow: hidden;
            border: 1px solid rgba(255, 215, 0, 0.3);
            backdrop-filter: blur(10px);
            position: relative;
            transform-style: preserve-3d;
            transform: translateZ(50px);
            transition: box-shadow 0.5s ease;
        }

        .music-player:hover {
            box-shadow: 
                0 25px 50px rgba(0, 0, 0, 0.9),
                0 0 40px rgba(0, 100, 0, 0.6),
                0 0 80px rgba(255, 215, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .player-header {
            background: linear-gradient(135deg, #006400 0%, #008000 100%);
            padding: 25px;
            text-align: center;
            position: relative;
            box-shadow: 0 5px 20px rgba(0, 100, 0, 0.5);
            border-bottom: 2px solid rgba(255, 215, 0, 0.5);
        }

        .player-header::after {
            content: "";
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.7), transparent);
        }

        .player-header h1 {
            font-size: 28px;
            margin-bottom: 8px;
            color: #FFD700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            font-weight: 700;
            letter-spacing: 1px;
        }

        .player-header p {
            font-size: 15px;
            opacity: 0.9;
            color: white;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }

        .album-art-container {
            position: relative;
            width: 240px;
            height: 240px;
            margin: 30px auto;
            border-radius: 50%;
            background: linear-gradient(135deg, #006400, #004d00);
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 
                0 15px 30px rgba(0, 0, 0, 0.6), 
                0 0 25px rgba(0, 100, 0, 0.6),
                0 0 40px rgba(255, 215, 0, 0.3),
                inset 0 0 20px rgba(0, 0, 0, 0.7);
            overflow: hidden;
            transition: transform 0.5s ease;
            transform-style: preserve-3d;
        }

        .album-art-container.rotating {
            animation: rotateAlbum 15s infinite linear;
        }

        @keyframes rotateAlbum {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .album-art-container:hover {
            transform: scale(1.05) rotateY(5deg);
        }

        .album-art-container::before {
            content: "";
            position: absolute;
            width: 60px;
            height: 60px;
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border-radius: 50%;
            z-index: 2;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);
            border: 2px solid rgba(255, 215, 0, 0.3);
        }

        .album-art {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            object-fit: cover;
            position: absolute;
            z-index: 1;
        }

        .album-art-shadow {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            box-shadow: 
                inset 0 0 30px rgba(0, 0, 0, 0.8),
                0 0 60px rgba(0, 100, 0, 0.4);
            z-index: 3;
            pointer-events: none;
        }

        .song-info {
            text-align: center;
            padding: 0 25px;
        }

        .song-title {
            font-size: 26px;
            font-weight: 700;
            margin-bottom: 8px;
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.6);
        }

        .song-artist {
            font-size: 17px;
            color: #e0e0e0;
            margin-bottom: 25px;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.4);
        }

        .progress-area {
            padding: 0 30px;
            margin-bottom: 25px;
        }

        .progress-bar {
            height: 10px;
            width: 100%;
            background: #1a1a1a;
            border-radius: 10px;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 
                inset 0 0 8px rgba(0, 0, 0, 0.7),
                0 2px 4px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .progress {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #006400, #00cc00);
            border-radius: 10px;
            transition: width 0.1s linear;
            box-shadow: 
                0 0 15px rgba(0, 100, 0, 0.7),
                inset 0 0 5px rgba(255, 255, 255, 0.2);
            position: relative;
        }

        .progress::after {
            content: "";
            position: absolute;
            top: 0;
            right: 0;
            width: 15px;
            height: 100%;
            background: #FFD700;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(255, 215, 0, 0.8);
        }

        .timer {
            display: flex;
            justify-content: space-between;
            margin-top: 12px;
            font-size: 15px;
            color: #e0e0e0;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 25px;
            gap: 30px;
        }

        .control-btn {
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: none;
            color: #e0e0e0;
            font-size: 20px;
            cursor: pointer;
            padding: 15px;
            border-radius: 50%;
            transition: all 0.3s ease;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 
                0 5px 15px rgba(0, 0, 0, 0.4),
                0 0 5px rgba(255, 215, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 215, 0, 0.1);
        }

        .control-btn:hover {
            background: linear-gradient(145deg, #006400, #004d00);
            transform: translateY(-3px);
            box-shadow: 
                0 8px 20px rgba(0, 0, 0, 0.5), 
                0 0 15px rgba(0, 100, 0, 0.5),
                0 0 25px rgba(255, 215, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            color: #FFD700;
        }

        .play-pause {
            width: 75px;
            height: 75px;
            background: linear-gradient(135deg, #006400, #008000);
            font-size: 28px;
            box-shadow: 
                0 8px 20px rgba(0, 0, 0, 0.5), 
                0 0 20px rgba(0, 100, 0, 0.6),
                0 0 30px rgba(255, 215, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            color: #FFD700;
        }

        .play-pause:hover {
            background: linear-gradient(135deg, #008000, #00cc00);
            transform: scale(1.1);
        }

        .file-input, .image-input {
            display: none;
        }

        .file-label, .image-label {
            display: block;
            text-align: center;
            background: linear-gradient(135deg, #1a1a1a, #2a2a2a);
            color: #e0e0e0;
            padding: 16px 25px;
            margin: 0 25px 25px;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.4);
            font-weight: 600;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.4);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .file-label:hover, .image-label:hover {
            background: linear-gradient(135deg, #006400, #008000);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.5);
            color: #FFD700;
        }

        .repeat-btn.active, .shuffle-btn.active {
            color: #00cc00;
            text-shadow: 0 0 15px rgba(0, 204, 0, 0.8);
            box-shadow: 
                0 0 20px rgba(0, 204, 0, 0.5),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .volume-control {
            display: flex;
            align-items: center;
            padding: 0 30px 25px;
            gap: 12px;
        }

        .volume-control i {
            color: #e0e0e0;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
            font-size: 20px;
        }

        .volume-slider {
            flex: 1;
            height: 8px;
            background: #1a1a1a;
            border-radius: 10px;
            position: relative;
            cursor: pointer;
            box-shadow: 
                inset 0 0 8px rgba(0, 0, 0, 0.7),
                0 2px 4px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .volume-progress {
            height: 100%;
            width: 70%;
            background: linear-gradient(90deg, #006400, #00cc00);
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 100, 0, 0.6);
        }

        .playlist {
            max-height: 200px;
            overflow-y: auto;
            margin: 0 25px 25px;
            border-radius: 12px;
            background: rgba(30, 30, 30, 0.7);
            box-shadow: 
                inset 0 0 15px rgba(0, 0, 0, 0.6),
                0 5px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .playlist-item {
            padding: 14px 18px;
            border-bottom: 1px solid rgba(60, 60, 60, 0.7);
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #e0e0e0;
        }

        .playlist-item:hover {
            background: rgba(0, 100, 0, 0.3);
        }

        .playlist-item.active {
            background: linear-gradient(135deg, #006400, #008000);
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.5);
            color: #FFD700;
        }

        .playlist-item i {
            color: #006400;
            text-shadow: 0 0 8px rgba(0, 100, 0, 0.5);
        }

        .playlist-item.active i {
            color: #FFD700;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
        }

        .playlist::-webkit-scrollbar {
            width: 10px;
        }

        .playlist::-webkit-scrollbar-track {
            background: #1a1a1a;
            border-radius: 10px;
        }

        .playlist::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, #006400, #008000);
            border-radius: 10px;
            box-shadow: 0 0 8px rgba(0, 100, 0, 0.5);
        }

        .songs-count {
            text-align: center;
            padding: 12px;
            color: #e0e0e0;
            font-size: 15px;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.3);
        }

        .visualizer-container {
            width: 100%;
            height: 90px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 20px 0;
        }

        .visualizer {
            display: flex;
            align-items: flex-end;
            justify-content: center;
            height: 70px;
            gap: 4px;
        }

        .bar {
            width: 5px;
            background: linear-gradient(to top, #006400, #00cc00);
            border-radius: 3px;
            transition: height 0.1s ease;
            box-shadow: 0 0 8px rgba(0, 100, 0, 0.5);
        }

        .camera-toggle {
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: none;
            color: #e0e0e0;
            padding: 12px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.3);
            z-index: 20;
            border: 1px solid rgba(255, 215, 0, 0.2);
            font-weight: 600;
        }

        .camera-toggle:hover {
            background: linear-gradient(145deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.5);
            color: #FFD700;
            transform: translateY(-2px);
        }

        .camera-toggle.active {
            background: linear-gradient(135deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.7);
            color: #FFD700;
        }

        .boost-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: none;
            color: #e0e0e0;
            padding: 12px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.3);
            z-index: 20;
            border: 1px solid rgba(255, 215, 0, 0.2);
            font-weight: 600;
        }

        .boost-btn:hover {
            background: linear-gradient(145deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.5);
            color: #FFD700;
            transform: translateY(-2px);
        }

        .boost-btn.active {
            background: linear-gradient(135deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.7);
            color: #FFD700;
        }

        .bass-indicator {
            width: 100%;
            height: 6px;
            background: #1a1a1a;
            border-radius: 5px;
            margin: 15px 30px 0;
            overflow: hidden;
            position: relative;
            box-shadow: 
                inset 0 0 8px rgba(0, 0, 0, 0.7),
                0 2px 4px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .bass-level {
            height: 100%;
            width: 0%;
            background: linear-gradient(90deg, #004d00, #006400);
            border-radius: 5px;
            transition: width 0.3s ease;
            box-shadow: 0 0 10px rgba(0, 100, 0, 0.6);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .pulse-effect {
            animation: pulse 0.5s infinite;
        }

        .shadow-layer {
            position: absolute;
            width: 90%;
            height: 50px;
            bottom: -25px;
            left: 5%;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.5);
            filter: blur(15px);
            z-index: -1;
            animation: shadowPulse 4s infinite alternate;
        }

        @keyframes shadowPulse {
            0% { opacity: 0.5; transform: scale(0.95); }
            100% { opacity: 0.8; transform: scale(1.05); }
        }

        .gold-glow {
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            border-radius: 27px;
            background: linear-gradient(45deg, transparent, rgba(255,215,0,0.1), transparent);
            z-index: -1;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .music-player:hover .gold-glow {
            opacity: 1;
        }

        .audio-controls {
            display: flex;
            justify-content: center;
            gap: 12px;
            padding: 0 30px 20px;
        }

        .audio-preset {
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: none;
            color: #e0e0e0;
            font-size: 13px;
            cursor: pointer;
            padding: 8px 15px;
            border-radius: 15px;
            transition: all 0.3s ease;
            box-shadow: 0 0 8px rgba(0, 100, 0, 0.2);
            border: 1px solid rgba(255, 215, 0, 0.1);
        }

        .audio-preset:hover {
            background: linear-gradient(145deg, #006400, #008000);
            color: #FFD700;
        }

        .audio-preset.active {
            background: linear-gradient(135deg, #006400, #008000);
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.5);
            color: #FFD700;
        }

        .player-glow {
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border-radius: 35px;
            background: radial-gradient(circle at center, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            z-index: -1;
            opacity: 0.7;
            filter: blur(20px);
        }

        .light-effect {
            position: fixed;
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 255, 255, 0.1) 0%, transparent 70%);
            filter: blur(40px);
            z-index: -1;
            animation: lightMove 15s infinite linear;
        }

        .light-effect:nth-child(1) {
            top: 10%;
            left: 10%;
            animation-delay: 0s;
        }

        .light-effect:nth-child(2) {
            bottom: 10%;
            right: 10%;
            animation-delay: 5s;
        }

        .light-effect:nth-child(3) {
            top: 50%;
            left: 50%;
            animation-delay: 10s;
        }

        @keyframes lightMove {
            0% { transform: translate(0, 0) scale(1); }
            25% { transform: translate(50px, 50px) scale(1.2); }
            50% { transform: translate(0, 100px) scale(1); }
            75% { transform: translate(-50px, 50px) scale(1.2); }
            100% { transform: translate(0, 0) scale(1); }
        }
        
        .advanced-section {
            flex: 1;
            min-width: 500px;
            position: relative;
        }
        
        .advanced-controls {
            background: rgba(20, 20, 20, 0.9);
            border-radius: 25px;
            padding: 25px;
            border: 1px solid rgba(255, 215, 0, 0.3);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.8),
                0 0 30px rgba(0, 100, 0, 0.4),
                0 0 60px rgba(255, 215, 0, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            height: 100%;
            overflow-y: auto;
        }
        
        .advanced-controls h3 {
            text-align: center;
            color: #FFD700;
            margin-bottom: 25px;
            font-size: 24px;
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.5);
        }
        
        .eq-container {
            margin: 20px 0;
            overflow-x: auto;
        }
        
        .eq-band {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 4px;
            min-width: 40px;
        }
        
        .eq-bands-container {
            display: flex;
            justify-content: space-between;
            margin: 20px 0;
            min-width: 800px;
            padding: 0 10px;
        }
        
        .eq-slider {
            -webkit-appearance: slider-vertical;
            width: 25px;
            height: 100px;
            background: linear-gradient(to top, #006400, #00cc00);
            border-radius: 12px;
            outline: none;
            margin: 10px 0;
        }
        
        .eq-freq {
            font-size: 10px;
            color: #FFD700;
            margin-top: 5px;
            text-align: center;
        }
        
        .eq-value {
            font-size: 10px;
            color: #fff;
            margin-top: 5px;
        }
        
        .preset-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
        
        .preset-btn {
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: #e0e0e0;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }
        
        .preset-btn:hover, .preset-btn.active {
            background: linear-gradient(145deg, #006400, #008000);
            color: #FFD700;
        }
        
        .analysis-panel {
            background: rgba(10, 10, 10, 0.8);
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .spectrum-display {
            width: 100%;
            height: 100px;
            background: #0a0a0a;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .advanced-settings {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin: 20px 0;
        }
        
        .setting-group {
            background: rgba(15, 15, 15, 0.7);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .setting-slider {
            width: 100%;
            margin: 10px 0;
        }

        .quality-settings {
            background: rgba(15, 15, 15, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }

        .quality-settings select, .quality-settings input {
            background: #1a1a1a;
            color: white;
            border: 1px solid rgba(255, 215, 0, 0.3);
            padding: 8px;
            border-radius: 5px;
            margin: 5px 0;
            width: 100%;
        }

        .quality-settings label {
            display: flex;
            align-items: center;
            gap: 8px;
            margin: 10px 0;
            color: #e0e0e0;
        }
        
        /* Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù† */
        .audio-enhancement-controls {
            background: rgba(15, 15, 15, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border: 1px solid rgba(255, 215, 0, 0.2);
        }
        
        .enhancement-slider {
            width: 100%;
            margin: 10px 0;
        }
        
        .enhancement-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 14px;
            color: #e0e0e0;
        }
        
        .enhancement-value {
            color: #FFD700;
            font-weight: 600;
        }
        
        .enhancement-indicator {
            display: inline-block;
            padding: 2px 8px;
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            border-radius: 10px;
            font-size: 12px;
            margin-right: 5px;
        }
        
        .enhancement-presets {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }
        
        .enhancement-preset-btn {
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: 1px solid rgba(255, 215, 0, 0.3);
            color: #e0e0e0;
            padding: 6px 12px;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
            flex: 1;
            text-align: center;
        }
        
        .enhancement-preset-btn:hover, .enhancement-preset-btn.active {
            background: linear-gradient(145deg, #006400, #008000);
            color: #FFD700;
        }
        
        @media (max-width: 1100px) {
            .main-container {
                flex-direction: column;
            }
            
            .player-section, .advanced-section {
                min-width: 100%;
            }
        }
        
        /* Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ø§Ø³ active-glow Ø§Ù„Ù…ÙÙ‚ÙˆØ¯ */
        .active-glow {
            box-shadow: 0 0 20px rgba(0, 204, 0, 0.7) !important;
        }
        
        .glow-text {
            text-shadow: 0 0 10px rgba(255, 215, 0, 0.7);
        }

        /* Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ ÙˆÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© */
        .shortcuts-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .shortcuts-content {
            background: linear-gradient(145deg, #0a0a0a, #1a1a1a);
            border-radius: 20px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border: 2px solid rgba(255, 215, 0, 0.5);
            box-shadow: 0 0 40px rgba(255, 215, 0, 0.3);
        }
        
        .shortcuts-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 1px solid rgba(255, 215, 0, 0.3);
            padding-bottom: 10px;
        }
        
        .shortcuts-header h3 {
            color: #FFD700;
            margin: 0;
        }
        
        .close-modal {
            background: none;
            border: none;
            color: #FFD700;
            font-size: 24px;
            cursor: pointer;
        }
        
        .shortcut-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .shortcut-key {
            background: rgba(255, 215, 0, 0.2);
            color: #FFD700;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .shortcuts-btn {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: none;
            color: #e0e0e0;
            padding: 12px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.3);
            z-index: 20;
            border: 1px solid rgba(255, 215, 0, 0.2);
            font-weight: 600;
        }
        
        .shortcuts-btn:hover {
            background: linear-gradient(145deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.5);
            color: #FFD700;
            transform: translateY(-2px);
        }
        
        .format-support {
            text-align: center;
            color: #e0e0e0;
            margin-top: 10px;
            font-size: 14px;
            opacity: 0.8;
        }

        .fullscreen-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: none;
            color: #e0e0e0;
            padding: 12px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.3);
            z-index: 20;
            border: 1px solid rgba(255, 215, 0, 0.2);
            font-weight: 600;
        }

        .fullscreen-btn:hover {
            background: linear-gradient(145deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.5);
            color: #FFD700;
            transform: translateY(-2px);
        }

        body:fullscreen {
            padding: 0;
        }

        body:-webkit-full-screen {
            padding: 0;
        }

        body:-moz-full-screen {
            padding: 0;
        }

        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ù„Ù„Ø£Ø¬Ù‡Ø²Ø© Ø§Ù„Ù…Ø­Ù…ÙˆÙ„Ø© */
        @media (max-width: 768px) {
            .eq-bands-container {
                min-width: 600px;
            }
            
            .eq-slider {
                width: 20px;
                height: 80px;
            }
            
            .eq-freq {
                font-size: 8px;
            }
            
            .eq-value {
                font-size: 8px;
            }
        }
        
        /* ØªØ­Ø³ÙŠÙ†Ø§Øª Ø¥Ø¶Ø§ÙÙŠØ© Ù„Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© */
        .quality-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 10px 0;
            color: #FFD700;
        }
        
        .quality-bar {
            height: 6px;
            flex: 1;
            background: #1a1a1a;
            border-radius: 3px;
            overflow: hidden;
        }
        
        .quality-level {
            height: 100%;
            background: linear-gradient(90deg, #006400, #00cc00);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* Ø£Ù†Ù…Ø§Ø· Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ø¬Ø¯ÙŠØ¯ */
        .palace-effect-controls {
            background: rgba(15, 15, 15, 0.7);
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
            border: 1px solid rgba(0, 229, 255, 0.3);
        }

        .palace-effect-controls h4 {
            color: #00e5ff;
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 0 0 10px rgba(0, 229, 255, 0.5);
        }

        .palace-control-group {
            margin: 15px 0;
        }

        .palace-control-group label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 8px;
            font-size: 14px;
            color: #e0e0e0;
        }

        .palace-value {
            color: #00e5ff;
            font-weight: 600;
            background: rgba(0, 229, 255, 0.2);
            padding: 2px 10px;
            border-radius: 10px;
            min-width: 40px;
            text-align: center;
        }

        .palace-slider {
            width: 100%;
            height: 10px;
            -webkit-appearance: none;
            background: linear-gradient(90deg, #00e5ff 0%, #2979ff 100%);
            border-radius: 5px;
            outline: none;
        }

        .palace-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #fff;
            cursor: pointer;
            box-shadow: 0 0 10px rgba(0, 229, 255, 0.8);
        }

        .palace-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .palace-btn {
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: 1px solid rgba(0, 229, 255, 0.3);
            color: #e0e0e0;
            padding: 8px 15px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
            flex: 1;
            text-align: center;
        }

        .palace-btn:hover, .palace-btn.active {
            background: linear-gradient(145deg, #006400, #008000);
            color: #00e5ff;
            border-color: #00e5ff;
        }

        .palace-status {
            text-align: center;
            padding: 8px;
            margin: 10px 0;
            border-radius: 5px;
            font-size: 12px;
            background: rgba(0, 229, 255, 0.1);
            border: 1px solid rgba(0, 229, 255, 0.2);
            display: none;
        }

        .palace-toggle-btn {
            position: fixed;
            top: 20px;
            left: 180px;
            background: linear-gradient(145deg, #1a1a1a, #0a0a0a);
            border: none;
            color: #e0e0e0;
            padding: 12px 18px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 0 15px rgba(0, 100, 0, 0.3);
            z-index: 20;
            border: 1px solid rgba(0, 229, 255, 0.2);
            font-weight: 600;
        }

        .palace-toggle-btn:hover {
            background: linear-gradient(145deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.5);
            color: #00e5ff;
            transform: translateY(-2px);
        }

        .palace-toggle-btn.active {
            background: linear-gradient(135deg, #006400, #008000);
            box-shadow: 0 0 20px rgba(0, 100, 0, 0.7);
            color: #00e5ff;
        }

        .processing-indicator {
            display: none;
            text-align: center;
            margin: 10px 0;
            color: #00e5ff;
        }

        .processing-bar {
            width: 100%;
            height: 4px;
            background: rgba(255, 255, 255, 0.1);
            margin-top: 5px;
            border-radius: 2px;
            overflow: hidden;
        }

        .processing-progress {
            width: 0%;
            height: 100%;
            background: #00e5ff;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <!-- Ø§Ù„Ù†Ø¬ÙˆÙ… ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ© -->
    <div class="stars-background" id="starsBackground"></div>
    
    <!-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¶ÙˆØ¡ Ø§Ù„Ø«Ø§Ø¨ØªØ© -->
    <div class="light-effects">
        <div class="light-spot"></div>
        <div class="light-spot"></div>
        <div class="light-spot"></div>
    </div>
    
    <!-- ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© -->
    <div class="light-effect"></div>
    <div class="light-effect"></div>
    <div class="light-effect"></div>
    
    <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¹Ù„ÙˆÙŠØ© -->
    <button class="camera-toggle" id="cameraToggle">ØªØ´ØºÙŠÙ„ Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</button>
    <button class="palace-toggle-btn" id="palaceToggleBtn">Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ</button>
    <button class="boost-btn" id="boostBtn">ØªØ¶Ø®ÙŠÙ… Ø§Ù„ØµÙˆØª</button>
    
    <!-- Ø²Ø± ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø© -->
    <button class="power-save-btn" id="powerSaveBtn">ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø©</button>
    
    <!-- Ø²Ø± Ø¹Ø±Ø¶ Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ -->
    <button class="shortcuts-btn" id="shortcutsBtn">Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­</button>
    
    <!-- Ø²Ø± ÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© -->
    <button class="fullscreen-btn" id="fullscreenBtn">Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©</button>
    
    <!-- Ù†Ø§ÙØ°Ø© Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ -->
    <div class="shortcuts-modal" id="shortcutsModal">
        <div class="shortcuts-content">
            <div class="shortcuts-header">
                <h3>Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­</h3>
                <button class="close-modal" id="closeModal">âœ•</button>
            </div>
            <div class="shortcuts-list">
                <div class="shortcut-item">
                    <span>ØªØ´ØºÙŠÙ„/Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¤Ù‚Øª</span>
                    <span class="shortcut-key">Ù…Ø³Ø§ÙØ©</span>
                </div>
                <div class="shortcut-item">
                    <span>Ø§Ù„Ø£ØºÙ†ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©</span>
                    <span class="shortcut-key">â†’</span>
                </div>
                <div class="shortcut-item">
                    <span>Ø§Ù„Ø£ØºÙ†ÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©</span>
                    <span class="shortcut-key">â†</span>
                </div>
                <div class="shortcut-item">
                    <span>Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØµÙˆØª</span>
                    <span class="shortcut-key">â†‘</span>
                </div>
                <div class="shortcut-item">
                    <span>ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØª</span>
                    <span class="shortcut-key">â†“</span>
                </div>
                <div class="shortcut-item">
                    <span>ØªÙƒØ±Ø§Ø±</span>
                    <span class="shortcut-key">R</span>
                </div>
                <div class="shortcut-item">
                    <span>Ø¹Ø´ÙˆØ§Ø¦ÙŠ</span>
                    <span class="shortcut-key">S</span>
                </div>
                <div class="shortcut-item">
                    <span>ØªØ¶Ø®ÙŠÙ… Ø§Ù„ØµÙˆØª</span>
                    <span class="shortcut-key">B</span>
                </div>
                <div class="shortcut-item">
                    <span>Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§</span>
                    <span class="shortcut-key">C</span>
                </div>
                <div class="shortcut-item">
                    <span>ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø©</span>
                    <span class="shortcut-key">P</span>
                </div>
                <div class="shortcut-item">
                    <span>Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©</span>
                    <span class="shortcut-key">F11</span>
                </div>
                <div class="shortcut-item">
                    <span>Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª</span>
                    <span class="shortcut-key">H</span>
                </div>
                <div class="shortcut-item">
                    <span>Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ</span>
                    <span class="shortcut-key">T</span>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Ø§Ù„Ø­Ø§ÙˆÙŠØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
    <div class="main-container">
        <!-- Ù‚Ø³Ù… Ø§Ù„Ù…Ø´ØºÙ„ (Ø¹Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†) -->
        <div class="player-section" id="playerSection">
            <!-- Ø·Ø¨Ù‚Ø© Ø§Ù„Ø¸Ù„Ø§Ù„ -->
            <div class="shadow-layer"></div>
            
            <!-- Ø§Ù„ØªØ£Ù„Ù‚ Ø§Ù„Ø°Ù‡Ø¨ÙŠ -->
            <div class="gold-glow"></div>
            
            <!-- ØªØ£Ø«ÙŠØ± Ø§Ù„Ø¥Ø¶Ø§Ø¡Ø© -->
            <div class="player-glow"></div>
            
            <!-- Ù…Ø´ØºÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ -->
            <div class="music-player">
                <div class="player-header">
                    <h1 class="glow-text">Ø§Ù„Ù…Ø´ØºÙ„ Ø§Ù„Ø°Ù‡Ø¨ÙŠ Ø§Ù„ÙØ§Ø®Ø±</h1>
                    <p class="glow-text">Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù† Ù…Ø¹ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ</p>
                </div>
                
                <div class="album-art-container" id="albumArtContainer">
                    <img id="albumImage" class="album-art" src="" alt="ØºÙ„Ø§Ù Ø§Ù„Ø£ØºÙ†ÙŠØ©">
                    <div class="album-art-shadow"></div>
                </div>
                
                <!-- Ø²Ø± ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù -->
                <label for="imageInput" class="image-label glow-text">
                    Ø§Ø®ØªØ± ØµÙˆØ±Ø© ØºÙ„Ø§Ù
                </label>
                <input type="file" id="imageInput" class="image-input" accept="image/*">
                
                <div class="song-info">
                    <h2 class="song-title glow-text" id="songTitle">Ø§Ø®ØªØ± Ø£ØºÙ†ÙŠØ©</h2>
                    <p class="song-artist glow-text" id="songArtist">ÙÙ†Ø§Ù† ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ</p>
                </div>
                
                <!-- Ù…Ø¤Ø´Ø± Ø§Ù„Ù…ÙˆØ¬Ø© Ø§Ù„ØµÙˆØªÙŠØ© -->
                <div class="visualizer-container">
                    <div class="visualizer" id="visualizer"></div>
                </div>
                
                <!-- Ù…Ø¤Ø´Ø± Ø§Ù„Ø¨Ø§Ø³ -->
                <div class="bass-indicator">
                    <div class="bass-level" id="bassLevel"></div>
                </div>
                
                <div class="progress-area">
                    <div class="progress-bar" id="progressBar">
                        <div class="progress" id="progress"></div>
                    </div>
                    <div class="timer">
                        <span id="currentTime">0:00</span>
                        <span id="duration">0:00</span>
                    </div>
                </div>
                
                <div class="controls">
                    <button class="control-btn repeat-btn" id="repeatBtn" title="ØªÙƒØ±Ø§Ø±">
                        <i>ğŸ”</i>
                    </button>
                    <button class="control-btn prev-btn" id="prevBtn" title="Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©">
                        <i>â®ï¸</i>
                    </button>
                    <button class="control-btn play-pause" id="playPauseBtn" title="ØªØ´ØºÙŠÙ„ / Ø¥ÙŠÙ‚Ø§Ù">
                        <i>â–¶ï¸</i>
                    </button>
                    <button class="control-btn next-btn" id="nextBtn" title="Ø§Ù„ØªØ§Ù„ÙŠØ©">
                        <i>â­ï¸</i>
                    </button>
                    <button class="control-btn shuffle-btn" id="shuffleBtn" title="Ø¹Ø´ÙˆØ§Ø¦ÙŠ">
                        <i>ğŸ”€</i>
                    </button>
                </div>
                
                <!-- Ø£Ø²Ø±Ø§Ø± Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© -->
                <div class="audio-controls">
                    <button class="audio-preset" data-preset="bass">Ø¬Ù‡ÙŠØ± Ù…ÙƒØ«Ù</button>
                    <button class="audio-preset active" data-preset="normal">Ø¹Ø§Ø¯ÙŠ</button>
                    <button class="audio-preset" data-preset="treble">Ù†Ù‚Ø§Ø¡ Ø§Ù„ØµÙˆØª</button>
                    <button class="audio-preset" data-preset="palace">ÙˆØ¶Ø¹ Ø§Ù„Ù‚ØµØ±</button>
                </div>
                
                <div class="volume-control">
                    <i>ğŸ”Š</i>
                    <div class="volume-slider" id="volumeSlider">
                        <div class="volume-progress" id="volumeProgress"></div>
                    </div>
                </div>
                
                <label for="fileInput" class="file-label glow-text">
                    Ø§Ø®ØªØ± Ù…Ù„ÙØ§Øª Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ (Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØªÙ‡Ø§ Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø­Ø§Ù„ÙŠØ©)
                </label>
                <input type="file" id="fileInput" class="file-input" accept="audio/*, .mp3, .wav, .ogg, .aac, .flac, .m4a, .aiff, .wma, .alac" multiple>
                
                <div class="format-support">ÙŠØ¯Ø¹Ù…: MP3, WAV, OGG, AAC, FLAC, M4A, AIFF, WMA, ALAC</div>
                
                <div class="songs-count" id="songsCount">Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØºØ§Ù†ÙŠ: 0</div>
                
                <div class="playlist" id="playlist">
                    <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£ØºØ§Ù†ÙŠ Ù‡Ù†Ø§ -->
                </div>
            </div>
        </div>
        
        <!-- Ù‚Ø³Ù… Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ù…ØªÙ‚Ø¯Ù… (Ø¹Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±) -->
        <div class="advanced-section">
            <div class="advanced-controls">
                <h3>Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h3>
                
                <!-- Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ -->
                <div class="palace-effect-controls" id="palaceEffectControls" style="display: none;">
                    <h4>ğŸ° Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ</h4>
                    
                    <div class="processing-indicator" id="processingIndicator">
                        <div>âš¡ Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØª...</div>
                        <div class="processing-bar">
                            <div class="processing-progress" id="processingProgress"></div>
                        </div>
                    </div>
                    
                    <div class="palace-status" id="palaceStatus"></div>
                    
                    <div class="palace-control-group">
                        <label for="palaceSize">
                            <span>ğŸ° Ø­Ø¬Ù… Ø§Ù„Ù‚ØµØ±</span>
                            <span class="palace-value" id="palaceSizeValue">75%</span>
                        </label>
                        <input type="range" class="palace-slider" id="palaceSize" min="0" max="100" value="75">
                        <small style="color: #aaa; font-size: 11px;">Ø§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³Ø§Øª ÙˆØ§Ù„Ù…Ø³Ø§Ø­Ø©</small>
                    </div>
                    
                    <div class="palace-control-group">
                        <label for="palaceBrilliance">
                            <span>ğŸ’ Ø§Ù„Ù„Ù…Ø¹Ø§Ù†</span>
                            <span class="palace-value" id="palaceBrillianceValue">80%</span>
                        </label>
                        <input type="range" class="palace-slider" id="palaceBrilliance" min="0" max="100" value="80">
                        <small style="color: #aaa; font-size: 11px;">Ø§Ù„ØªØ±ÙŠØ¨Ù„ ÙˆØ§Ù„ÙˆØ¶ÙˆØ­</small>
                    </div>
                    
                    <div class="palace-control-group">
                        <label for="palaceMarble">
                            <span>ğŸª¨ Ø§Ù„Ø±Ø®Ø§Ù…ÙŠØ©</span>
                            <span class="palace-value" id="palaceMarbleValue">50%</span>
                        </label>
                        <input type="range" class="palace-slider" id="palaceMarble" min="0" max="100" value="50">
                        <small style="color: #aaa; font-size: 11px;">Ø§Ù„Ø±Ù†ÙŠÙ† ÙˆØ§Ù„Ø¯ÙØ¡</small>
                    </div>
                    
                    <div class="palace-control-group">
                        <label for="palaceAir">
                            <span>ğŸŒ¬ï¸ Ø§Ù„Ù‡ÙˆØ§Ø¡</span>
                            <span class="palace-value" id="palaceAirValue">60%</span>
                        </label>
                        <input type="range" class="palace-slider" id="palaceAir" min="0" max="100" value="60">
                        <small style="color: #aaa; font-size: 11px;">Ø§Ù„ØªØ±Ø¯Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù„ÙŠØ©</small>
                    </div>
                    
                    <div class="palace-buttons">
                        <button class="palace-btn" id="applyPalaceEffect">ğŸšï¸ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ£Ø«ÙŠØ±</button>
                        <button class="palace-btn" id="resetPalaceEffect">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                        <button class="palace-btn" id="downloadProcessed">ğŸ’¾ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù†ØªÙŠØ¬Ø©</button>
                    </div>
                </div>
                
                <!-- Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù† -->
                <div class="audio-enhancement-controls">
                    <h4 style="color: #FFD700;">Ù†Ø¸Ø§Ù… ØªØ¶Ø®ÙŠÙ… Ø§Ù„ØµÙˆØª Ø§Ù„Ø°ÙƒÙŠ</h4>
                    
                    <div class="enhancement-label">
                        <span>ğŸ”Š Ø§Ù„ØµÙˆØª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ</span>
                        <span class="enhancement-value" id="volumeValue">70%</span>
                    </div>
                    <input type="range" class="enhancement-slider" id="volumeEnhancementSlider" min="0" max="100" value="70">
                    
                    <div class="enhancement-label">
                        <span>ğŸ’¥ ØªØ¶Ø®ÙŠÙ… Ø§Ù„ØµÙˆØª <span class="enhancement-indicator" id="boostIndicator">x1.0</span></span>
                        <span class="enhancement-value" id="boostValue">0%</span>
                    </div>
                    <input type="range" class="enhancement-slider" id="boostEnhancementSlider" min="0" max="100" value="0">
                    
                    <div class="enhancement-label">
                        <span>ğŸšï¸ ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¬Ù‡ÙŠØ±</span>
                        <span class="enhancement-value" id="bassValue">0%</span>
                    </div>
                    <input type="range" class="enhancement-slider" id="bassEnhancementSlider" min="0" max="100" value="0">
                    
                    <!-- Ù…Ø¤Ø´Ø± Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØª -->
                    <div class="quality-indicator">
                        <span>ğŸµ Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØª:</span>
                        <div class="quality-bar">
                            <div class="quality-level" id="qualityLevel" style="width: 90%;"></div>
                        </div>
                        <span id="qualityValue">Ø¹Ø§Ù„ÙŠØ©</span>
                    </div>
                    
                    <div class="enhancement-presets">
                        <button class="enhancement-preset-btn active" data-preset="normal">Ø¹Ø§Ø¯ÙŠ</button>
                        <button class="enhancement-preset-btn" data-preset="boost">ØªØ¶Ø®ÙŠÙ…</button>
                        <button class="enhancement-preset-btn" data-preset="bass">Ø¬Ù‡ÙŠØ±</button>
                        <button class="enhancement-preset-btn" data-preset="clear">ØµÙˆØª Ù†Ù‚ÙŠ</button>
                    </div>
                </div>
                
                <!-- Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØª -->
                <div class="quality-settings">
                    <h4 style="color: #FFD700;">Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØª</h4>
                    <label>Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØª:</label>
                    <select id="audioQuality">
                        <option value="standard">Ù‚ÙŠØ§Ø³ÙŠ (44.1kHz)</option>
                        <option value="high">Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© (48kHz)</option>
                        <option value="hd" selected>Ø¹Ø§Ù„ÙŠØ© Ø§Ù„Ø¯Ù‚Ø© (96kHz)</option>
                    </select>
                    
                    <label>
                        <input type="checkbox" id="enableDithering" checked> 
                        ØªÙ…ÙƒÙŠÙ† Dithering (Ù„Ø¬ÙˆØ¯Ø© Ø£ÙØ¶Ù„ ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ù…Ù†Ø®ÙØ¶Ø©)
                    </label>
                    
                    <label>
                        <input type="checkbox" id="enableCompressor" checked> 
                        ØªÙ…ÙƒÙŠÙ† Compressor (Ù„ØªÙˆØ§Ø²Ù† Ø§Ù„ØµÙˆØª)
                    </label>
                </div>
                
                <!-- Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„ 18-Ù†Ø·Ø§Ù‚Ø§Øª -->
                <div class="eq-container">
                    <h4 style="color: #e0e0e0; text-align: center;">Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ (18 Ù†Ø·Ø§Ù‚)</h4>
                    <div class="eq-bands-container" id="eqBands">
                        <!-- Ø³ÙŠØªÙ… Ø¥Ø¶Ø§ÙØ© Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„ Ù‡Ù†Ø§ -->
                    </div>
                    
                    <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø© -->
                    <div class="preset-buttons">
                        <button class="preset-btn active" data-preset="flat">Ù…Ø³Ø·Ø­</button>
                        <button class="preset-btn" data-preset="bass">Ø¬Ù‡ÙŠØ± Ù…ÙƒØ«Ù</button>
                        <button class="preset-btn" data-preset="vocal">ÙˆØ§Ø¶Ø­ Ø§Ù„ØµÙˆØª</button>
                        <button class="preset-btn" data-preset="acoustic">Ø£ÙƒÙˆØ³ØªÙŠÙƒ</button>
                        <button class="preset-btn" data-preset="rock">Ø±ÙˆÙƒ</button>
                        <button class="preset-btn" data-preset="jazz">Ø¬Ø§Ø²</button>
                        <button class="preset-btn" data-preset="classical">ÙƒÙ„Ø§Ø³ÙŠÙƒÙŠ</button>
                        <button class="preset-btn" data-preset="electronic">Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ</button>
                        <button class="preset-btn" data-preset="hardstyle">Ù‡Ø§Ø±Ø¯Ø³ØªØ§ÙŠÙ„</button>
                    </div>
                </div>
                
                <!-- Ù…Ø­Ù„Ù„ Ø§Ù„Ø·ÙŠÙ -->
                <div class="analysis-panel">
                    <h4 style="color: #e0e0e0; text-align: center;">Ù…Ø­Ù„Ù„ Ø§Ù„Ø·ÙŠÙ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ</h4>
                    <div class="spectrum-display" id="spectrumDisplay">
                        <!-- Ø³ÙŠØªÙ… Ø¹Ø±Ø¶ Ø§Ù„Ø·ÙŠÙ Ù‡Ù†Ø§ -->
                    </div>
                </div>
                
                <!-- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© -->
                <div class="advanced-settings">
                    <div class="setting-group">
                        <h5 style="color: #FFD700;">Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„</h5>
                        <label style="color: #e0e0e0;">Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ´ØºÙŠÙ„</label>
                        <input type="range" class="setting-slider" id="playbackSpeed" min="50" max="200" value="100">
                        <span id="speedValue" style="color: #e0e0e0;">100%</span>
                        
                        <label style="color: #e0e0e0; display: block; margin-top: 10px;">Ø§Ù„ØªØ¯Ø§Ø®Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£ØºØ§Ù†ÙŠ</label>
                        <input type="range" class="setting-slider" id="crossfade" min="0" max="10" value="0">
                        <span id="crossfadeValue" style="color: #e0e0e0;">0 Ø«Ø§Ù†ÙŠØ©</span>
                    </div>
                    
                    <div class="setting-group">
                        <h5 style="color: #FFD700;">Ø§Ù„ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ©</h5>
                        <label style="color: #e0e0e0;">Ø§Ù„ØµØ¯Ù‰</label>
                        <input type="range" class="setting-slider" id="reverb" min="0" max="100" value="0">
                        <span id="reverbValue" style="color: #e0e0e0;">0%</span>
                        
                        <label style="color: #e0e0e0; display: block; margin-top: 10px;">Ø§Ù„ØªÙƒØ±Ø§Ø± A-B</label>
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <button class="preset-btn" id="setPointA">ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù‚Ø·Ø© A</button>
                            <button class="preset-btn" id="setPointB">ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù‚Ø·Ø© B</button>
                            <button class="preset-btn" id="toggleABRepeat">ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙƒØ±Ø§Ø±</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ù†Ø¬ÙˆÙ… ÙÙŠ Ø§Ù„Ø®Ù„ÙÙŠØ©
            function createStars() {
                const starsBackground = document.getElementById('starsBackground');
                const starCount = 160;
                
                for (let i = 0; i < starCount; i++) {
                    const star = document.createElement('div');
                    star.classList.add('star');
                    
                    const size = Math.random() * 3 + 1;
                    star.style.width = `${size}px`;
                    star.style.height = `${size}px`;
                    
                    star.style.left = `${Math.random() * 100}%`;
                    star.style.top = `${Math.random() * 100}%`;
                    
                    const delay = Math.random() * 4;
                    const duration = Math.random() * 3 + 2;
                    star.style.animationDelay = `${delay}s`;
                    star.style.animationDuration = `${duration}s`;
                    
                    starsBackground.appendChild(star);
                }
            }
            
            createStars();
            
            // Ø²Ø± ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø©
            const powerSaveBtn = document.getElementById('powerSaveBtn');
            let isPowerSaveMode = false;
            
            powerSaveBtn.addEventListener('click', function() {
                isPowerSaveMode = !isPowerSaveMode;
                document.body.classList.toggle('power-save-mode', isPowerSaveMode);
                
                if (isPowerSaveMode) {
                    powerSaveBtn.textContent = 'ÙˆØ¶Ø¹ Ø§Ù„Ø¹Ø§Ø¯ÙŠ';
                    powerSaveBtn.classList.add('active');
                    
                    // Ø¥ÙŠÙ‚Ø§Ù Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¥Ø°Ø§ ÙƒØ§Ù† Ø´ØºØ§Ù„Ø§Ù‹
                    if (isCameraRotating) {
                        cameraToggle.click();
                    }
                    
                    // Ø¥ÙŠÙ‚Ø§Ù Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ØºÙ„Ø§Ù
                    stopAlbumRotation();
                    
                    // Ø¥Ø®ÙØ§Ø¡ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø¥Ø°Ø§ ÙƒØ§Ù† Ø¸Ø§Ù‡Ø±Ø§Ù‹
                    if (palaceEffectEnabled) {
                        palaceToggleBtn.click();
                    }
                } else {
                    powerSaveBtn.textContent = 'ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø©';
                    powerSaveBtn.classList.remove('active');
                }
            });
            
            // Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
            const audio = new Audio();
            const playPauseBtn = document.getElementById('playPauseBtn');
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            const repeatBtn = document.getElementById('repeatBtn');
            const shuffleBtn = document.getElementById('shuffleBtn');
            const progressBar = document.getElementById('progressBar');
            const progress = document.getElementById('progress');
            const currentTimeEl = document.getElementById('currentTime');
            const durationEl = document.getElementById('duration');
            const volumeSlider = document.getElementById('volumeSlider');
            const volumeProgress = document.getElementById('volumeProgress');
            const fileInput = document.getElementById('fileInput');
            const imageInput = document.getElementById('imageInput');
            const playlist = document.getElementById('playlist');
            const songTitle = document.getElementById('songTitle');
            const songArtist = document.getElementById('songArtist');
            const albumImage = document.getElementById('albumImage');
            const albumArtContainer = document.getElementById('albumArtContainer');
            const songsCount = document.getElementById('songsCount');
            const cameraToggle = document.getElementById('cameraToggle');
            const boostBtn = document.getElementById('boostBtn');
            const visualizer = document.getElementById('visualizer');
            const bassLevel = document.getElementById('bassLevel');
            const audioPresets = document.querySelectorAll('.audio-preset');
            const audioQuality = document.getElementById('audioQuality');
            const enableDithering = document.getElementById('enableDithering');
            const enableCompressor = document.getElementById('enableCompressor');
            const palaceToggleBtn = document.getElementById('palaceToggleBtn');
            const palaceEffectControls = document.getElementById('palaceEffectControls');
            
            // Ø¹Ù†Ø§ØµØ± Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ
            const palaceSize = document.getElementById('palaceSize');
            const palaceBrilliance = document.getElementById('palaceBrilliance');
            const palaceMarble = document.getElementById('palaceMarble');
            const palaceAir = document.getElementById('palaceAir');
            const palaceSizeValue = document.getElementById('palaceSizeValue');
            const palaceBrillianceValue = document.getElementById('palaceBrillianceValue');
            const palaceMarbleValue = document.getElementById('palaceMarbleValue');
            const palaceAirValue = document.getElementById('palaceAirValue');
            const applyPalaceEffectBtn = document.getElementById('applyPalaceEffect');
            const resetPalaceEffectBtn = document.getElementById('resetPalaceEffect');
            const downloadProcessedBtn = document.getElementById('downloadProcessed');
            const palaceStatus = document.getElementById('palaceStatus');
            const processingIndicator = document.getElementById('processingIndicator');
            const processingProgress = document.getElementById('processingProgress');
            
            // Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù† - Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            const volumeEnhancementSlider = document.getElementById('volumeEnhancementSlider');
            const boostEnhancementSlider = document.getElementById('boostEnhancementSlider');
            const bassEnhancementSlider = document.getElementById('bassEnhancementSlider');
            const volumeValue = document.getElementById('volumeValue');
            const boostValue = document.getElementById('boostValue');
            const bassValue = document.getElementById('bassValue');
            const boostIndicator = document.getElementById('boostIndicator');
            const enhancementPresetButtons = document.querySelectorAll('.enhancement-preset-btn');
            const qualityLevel = document.getElementById('qualityLevel');
            const qualityValue = document.getElementById('qualityValue');
            
            // ØªÙ‡ÙŠØ¦Ø© AudioContext Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
            let audioContext;
            let compressor;
            let analyser;
            let filters = [];
            let isHighQualityEnabled = false;
            
            // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù†
            let source;
            let gainNode;
            let bassBoost;
            let isAudioContextInitialized = false;
            let currentVolume = 0.7;
            let boostLevel = 1.0;
            let bassLevelValue = 0;
            
            // Ù†Ø¸Ø§Ù… Ø§Ù„ØµØ¯Ù‰ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ù…Ø¶Ø§ÙØ©
            let reverbNode;
            let reverbGain;
            let dryGain;
            
            // Ø¹Ù†Ø§ØµØ± Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­ ÙˆÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
            const shortcutsBtn = document.getElementById('shortcutsBtn');
            const shortcutsModal = document.getElementById('shortcutsModal');
            const closeModal = document.getElementById('closeModal');
            const fullscreenBtn = document.getElementById('fullscreenBtn');
            
            // Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ - Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª
            let palaceEffectEnabled = false;
            let isProcessingPalaceEffect = false;
            let processedAudioBuffer = null;
            let originalAudioBuffer = null;
            let palaceParams = {
                size: 0.75,
                brilliance: 0.80,
                marble: 0.50,
                air: 0.60
            };
            
            // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ù†Ø§ÙØ°Ø© Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª
            shortcutsBtn.addEventListener('click', function() {
                shortcutsModal.style.display = 'flex';
            });
            
            closeModal.addEventListener('click', function() {
                shortcutsModal.style.display = 'none';
            });
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ø§ÙØ°Ø© Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬Ù‡Ø§
            shortcutsModal.addEventListener('click', function(e) {
                if (e.target === shortcutsModal) {
                    shortcutsModal.style.display = 'none';
                }
            });
            
            // ÙˆØ¶Ø¹ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©
            fullscreenBtn.addEventListener('click', function() {
                if (!document.fullscreenElement) {
                    document.documentElement.requestFullscreen().catch(err => {
                        console.log(`Ø®Ø·Ø£ ÙÙŠ Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©: ${err.message}`);
                    });
                    fullscreenBtn.textContent = 'Ø®Ø±ÙˆØ¬ Ù…Ù† Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©';
                } else {
                    if (document.exitFullscreen) {
                        document.exitFullscreen();
                        fullscreenBtn.textContent = 'Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©';
                    }
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ù†Øµ Ø²Ø± Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø®Ø±ÙˆØ¬
            document.addEventListener('fullscreenchange', function() {
                if (!document.fullscreenElement) {
                    fullscreenBtn.textContent = 'Ù…Ù„Ø¡ Ø§Ù„Ø´Ø§Ø´Ø©';
                }
            });
            
            // ØªÙ‡ÙŠØ¦Ø© AudioContext Ø§Ù„Ù…Ø­Ø³Ù† - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø­Ø³Ù† Ù…Ø¹ Ø§Ù„ØµØ¯Ù‰
            async function initHighQualityAudio() {
                try {
                    if (audioContext) {
                        await audioContext.close();
                    }
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ AudioContext Ø¬Ø¯ÙŠØ¯
                    audioContext = new (window.AudioContext || window.webkitAudioContext)({
                        sampleRate: 44100,
                        latencyHint: 'interactive'
                    });
                    
                    // Ø§Ù†ØªØ¸Ø± Ø­ØªÙ‰ ÙŠÙƒÙˆÙ† AudioContext Ø¬Ø§Ù‡Ø²Ø§Ù‹
                    if (audioContext.state === 'suspended') {
                        await audioContext.resume();
                    }
                    
                    // ØªÙ‡ÙŠØ¦Ø© Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù†
                    source = audioContext.createMediaElementSource(audio);
                    gainNode = audioContext.createGain();
                    compressor = audioContext.createDynamicsCompressor();
                    
                    // Ø¥Ø¹Ø¯Ø§Ø¯ Compressor Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„ØµÙˆØª
                    compressor.threshold.value = -20;
                    compressor.knee.value = 10;
                    compressor.ratio.value = 4;
                    compressor.attack.value = 0.1;
                    compressor.release.value = 0.25;
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø±Ø´Ø­ Bass Boost
                    bassBoost = audioContext.createBiquadFilter();
                    bassBoost.type = 'lowshelf';
                    bassBoost.frequency.value = 200;
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Analyser Ù„Ù„Ø·ÙŠÙ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
                    analyser = audioContext.createAnalyser();
                    analyser.fftSize = 512; // Ø²ÙŠØ§Ø¯Ø© Ø­Ø¬Ù… FFT Ù„ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø¯Ù‚Ø©
                    analyser.smoothingTimeConstant = 0.8;
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø±Ø´Ø­Ø§Øª Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„ - 18 Ù†Ø·Ø§Ù‚
                    filters = [];
                    eqBands.forEach((band, index) => {
                        const filter = audioContext.createBiquadFilter();
                        
                        if (band.type === 'lowshelf') {
                            filter.type = 'lowshelf';
                            filter.frequency.value = 20;
                        } else if (band.type === 'highshelf') {
                            filter.type = 'highshelf';
                            filter.frequency.value = 20000;
                        } else {
                            filter.type = 'peaking';
                            filter.frequency.value = band.freqValue;
                            filter.Q.value = 0.7;
                        }
                        
                        filter.gain.value = band.value;
                        filters.push(filter);
                    });
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„ØµØ¯Ù‰ Ø§Ù„Ù…ØªÙ‚Ø¯Ù…
                    reverbNode = audioContext.createConvolver();
                    reverbGain = audioContext.createGain();
                    reverbGain.gain.value = 0; // Ø§Ù„Ø¨Ø¯Ø¡ Ø¨Ù‚ÙŠÙ…Ø© 0
                    
                    dryGain = audioContext.createGain();
                    dryGain.gain.value = 1;
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø¨Ø¶Ø© ØµØ¯Ù‰ Ø§ØµØ·Ù†Ø§Ø¹ÙŠØ©
                    function createReverbImpulseResponse(duration, decay, reverse) {
                        const sampleRate = audioContext.sampleRate;
                        const length = sampleRate * duration;
                        const impulse = audioContext.createBuffer(2, length, sampleRate);
                        const left = impulse.getChannelData(0);
                        const right = impulse.getChannelData(1);

                        for (let i = 0; i < length; i++) {
                            const n = reverse ? length - i : i;
                            left[i] = (Math.random() * 2 - 1) * Math.pow(1 - n / length, decay);
                            right[i] = (Math.random() * 2 - 1) * Math.pow(1 - n / length, decay);
                        }

                        return impulse;
                    }

                    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµØ¯Ù‰ Ø¨Ø§Ù„Ù†Ø¨Ø¶Ø© Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠØ©
                    try {
                        reverbNode.buffer = createReverbImpulseResponse(2, 2, false);
                    } catch (error) {
                        console.log("Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµØ¯Ù‰:", error);
                    }
                    
                    // ØªÙˆØµÙŠÙ„ Ø³Ù„Ø³Ù„Ø© Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù†Ø©
                    let lastNode = source;

                    // ØªÙˆØµÙŠÙ„ Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù†
                    lastNode.connect(bassBoost);
                    lastNode = bassBoost;

                    if (enableCompressor.checked) {
                        lastNode.connect(compressor);
                        lastNode = compressor;
                    }

                    filters.forEach(filter => {
                        lastNode.connect(filter);
                        lastNode = filter;
                    });

                    // ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø¬Ø§Ù (Ø¨Ø¯ÙˆÙ† ØµØ¯Ù‰)
                    lastNode.connect(dryGain);
                    dryGain.connect(gainNode);

                    // ØªÙˆØµÙŠÙ„ Ø§Ù„Ù…Ø³Ø§Ø± Ø§Ù„Ø±Ø·Ø¨ (Ø¨Ø§Ù„ØµØ¯Ù‰)
                    lastNode.connect(reverbNode);
                    reverbNode.connect(reverbGain);
                    reverbGain.connect(gainNode);

                    gainNode.connect(analyser);
                    analyser.connect(audioContext.destination);
                    
                    isHighQualityEnabled = true;
                    isAudioContextInitialized = true;
                    
                    // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø± Ø§Ù„Ø¬ÙˆØ¯Ø©
                    updateQualityIndicator();
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
                    applyBoost();
                    
                    // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø¨ØµØ±ÙŠØ© Ø¨Ø¹Ø¯ Ø§ÙƒØªÙ…Ø§Ù„ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙˆØª
                    setTimeout(() => {
                        initRealVisualizer();
                        initSpectrumAnalyzer();
                    }, 300);
                    
                } catch (error) {
                    console.log("Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙˆØª Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø©:", error);
                    isHighQualityEnabled = false;
                    isAudioContextInitialized = false;
                    updateQualityIndicator();
                }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø± Ø¬ÙˆØ¯Ø© Ø§Ù„ØµÙˆØª
            function updateQualityIndicator() {
                if (isHighQualityEnabled && isAudioContextInitialized) {
                    qualityLevel.style.width = '90%';
                    qualityValue.textContent = 'Ø¹Ø§Ù„ÙŠØ©';
                } else {
                    qualityLevel.style.width = '30%';
                    qualityValue.textContent = 'Ù…Ù†Ø®ÙØ¶Ø©';
                }
            }
            
            // ØªÙ‡ÙŠØ¦Ø© Ù…Ø­Ù„Ù„ Ø§Ù„Ø·ÙŠÙ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ
            function initSpectrumAnalyzer() {
                if (!analyser) {
                    console.log("Ø§Ù„Ù…Ø­Ù„Ù„ ØºÙŠØ± Ø¬Ø§Ù‡Ø² Ù„Ù„Ø·ÙŠÙ");
                    return;
                }
                
                const spectrumDisplay = document.getElementById('spectrumDisplay');
                if (!spectrumDisplay) {
                    console.log("Ø¹Ù†ØµØ± Ø§Ù„Ø·ÙŠÙ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯");
                    return;
                }
                
                // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¹Ø±Ø¶ Ø£ÙˆÙ„Ø§Ù‹
                spectrumDisplay.innerHTML = '';
                
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                
                // Ø¥Ø¹Ø¯Ø§Ø¯ Ø£Ø¨Ø¹Ø§Ø¯ Ø§Ù„Ù€ canvas
                function resizeCanvas() {
                    canvas.width = spectrumDisplay.clientWidth;
                    canvas.height = spectrumDisplay.clientHeight;
                    canvas.style.width = '100%';
                    canvas.style.height = '100%';
                    canvas.style.display = 'block';
                }
                
                resizeCanvas();
                spectrumDisplay.appendChild(canvas);
                
                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);
                
                function drawSpectrum() {
                    if (!analyser) {
                        requestAnimationFrame(drawSpectrum);
                        return;
                    }
                    
                    try {
                        analyser.getByteFrequencyData(dataArray);
                        
                        // Ù…Ø³Ø­ Ø§Ù„Ù€ canvas
                        ctx.fillStyle = '#0a0a0a';
                        ctx.fillRect(0, 0, canvas.width, canvas.height);
                        
                        const barWidth = (canvas.width / bufferLength) * 2.5;
                        let barHeight;
                        let x = 0;
                        
                        // Ø±Ø³Ù… Ø§Ù„Ø£Ø´Ø±Ø·Ø© Ø§Ù„Ø·ÙŠÙÙŠØ©
                        for(let i = 0; i < bufferLength; i++) {
                            barHeight = (dataArray[i] / 255) * canvas.height;
                            
                            // Ø¥Ù†Ø´Ø§Ø¡ ØªØ¯Ø±Ø¬ Ù„ÙˆÙ†ÙŠ
                            const gradient = ctx.createLinearGradient(0, canvas.height, 0, canvas.height - barHeight);
                            gradient.addColorStop(0, '#006400');
                            gradient.addColorStop(0.7, '#00cc00');
                            gradient.addColorStop(1, '#66ff66');
                            
                            ctx.fillStyle = gradient;
                            ctx.fillRect(x, canvas.height - barHeight, barWidth, barHeight);
                            
                            x += barWidth + 1;
                        }
                        
                        // Ø±Ø³Ù… Ø®Ø· Ù…Ù†ØªØµÙ Ù„Ù„Ø²ÙŠÙ†Ø©
                        ctx.strokeStyle = 'rgba(255, 215, 0, 0.3)';
                        ctx.setLineDash([5, 3]);
                        ctx.beginPath();
                        ctx.moveTo(0, canvas.height / 2);
                        ctx.lineTo(canvas.width, canvas.height / 2);
                        ctx.stroke();
                        ctx.setLineDash([]);
                        
                    } catch (error) {
                        console.log("Ø®Ø·Ø£ ÙÙŠ Ø±Ø³Ù… Ø§Ù„Ø·ÙŠÙ:", error);
                    }
                    
                    requestAnimationFrame(drawSpectrum);
                }
                
                drawSpectrum();
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø±Ø³Ù… Ø§Ù„Ø·ÙŠÙ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø­Ø¬Ù… Ø§Ù„Ù†Ø§ÙØ°Ø©
                window.addEventListener('resize', resizeCanvas);
            }
            
            // ØªØ·Ø¨ÙŠÙ‚ ØªØ¶Ø®ÙŠÙ… Ø§Ù„ØµÙˆØª
            function applyBoost() {
                if (!isAudioContextInitialized) return;
                
                // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¶Ø®ÙŠÙ…
                gainNode.gain.value = currentVolume * boostLevel;
                
                // ØªØ·Ø¨ÙŠÙ‚ Bass Boost
                bassBoost.gain.value = bassLevelValue;
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø´Ø±Ø§Øª
                volumeValue.textContent = `${Math.round(currentVolume * 100)}%`;
                boostValue.textContent = `${Math.round((boostLevel - 1) * 100)}%`;
                boostIndicator.textContent = `x${boostLevel.toFixed(1)}`;
                bassValue.textContent = `${Math.round(bassLevelValue)}%`;
            }
            
            // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙˆØª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ
            volumeEnhancementSlider.addEventListener('input', function() {
                const volumePercent = this.value;
                currentVolume = volumePercent / 100;
                audio.volume = currentVolume;
                volumeProgress.style.width = `${currentVolume * 100}%`;
                
                applyBoost();
            });
            
            // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ ØªØ¶Ø®ÙŠÙ… Ø§Ù„ØµÙˆØª
            boostEnhancementSlider.addEventListener('input', function() {
                const boostPercent = this.value;
                
                // ØªØ¶Ø®ÙŠÙ… Ù…Ù† 1.0 Ø¥Ù„Ù‰ 3.0
                boostLevel = 1.0 + (boostPercent / 100 * 2.0);
                
                applyBoost();
            });
            
            // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¬Ù‡ÙŠØ±
            bassEnhancementSlider.addEventListener('input', function() {
                const bassPercent = this.value;
                
                // ØªØ¹Ø²ÙŠØ² Ù…Ù† 0 Ø¥Ù„Ù‰ 30 dB
                bassLevelValue = bassPercent / 100 * 30;
                
                applyBoost();
            });
            
            // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø© Ù„Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù†
            enhancementPresetButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const preset = this.dataset.preset;
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                    enhancementPresetButtons.forEach(b => b.classList.remove('active'));
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø· Ù„Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
                    this.classList.add('active');
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø©
                    switch(preset) {
                        case 'normal':
                            // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ† Ø¥Ù„Ù‰ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠ
                            boostLevel = 1.0;
                            bassLevelValue = 0;
                            boostEnhancementSlider.value = 0;
                            bassEnhancementSlider.value = 0;
                            break;
                            
                        case 'boost':
                            // ØªØ¶Ø®ÙŠÙ… Ø§Ù„ØµÙˆØª
                            boostLevel = 2.0;
                            bassLevelValue = 5;
                            boostEnhancementSlider.value = 50;
                            bassEnhancementSlider.value = 17;
                            break;
                            
                        case 'bass':
                            // ØªØ¹Ø²ÙŠØ² Ø§Ù„Ø¬Ù‡ÙŠØ±
                            boostLevel = 1.5;
                            bassLevelValue = 20;
                            boostEnhancementSlider.value = 25;
                            bassEnhancementSlider.value = 67;
                            break;
                            
                        case 'clear':
                            // ØµÙˆØª Ù†Ù‚ÙŠ Ù…Ø¹ ØªØ¶Ø®ÙŠÙ… Ø®ÙÙŠÙ
                            boostLevel = 1.2;
                            bassLevelValue = 10;
                            boostEnhancementSlider.value = 10;
                            bassEnhancementSlider.value = 33;
                            break;
                    }
                    
                    applyBoost();
                });
            });
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„ Ø§Ù„Ù…ØªÙ‚Ø¯Ù… - 18 Ù†Ø·Ø§Ù‚
            const eqBandsContainer = document.getElementById('eqBands');
            const eqBands = [
                { freq: '20Hz', type: 'lowshelf', value: 0, freqValue: 20 },
                { freq: '32Hz', value: 0, freqValue: 32 },
                { freq: '50Hz', value: 0, freqValue: 50 },
                { freq: '80Hz', value: 0, freqValue: 80 },
                { freq: '125Hz', value: 0, freqValue: 125 },
                { freq: '200Hz', value: 0, freqValue: 200 },
                { freq: '315Hz', value: 0, freqValue: 315 },
                { freq: '500Hz', value: 0, freqValue: 500 },
                { freq: '800Hz', value: 0, freqValue: 800 },
                { freq: '1.2kHz', value: 0, freqValue: 1200 },
                { freq: '2kHz', value: 0, freqValue: 2000 },
                { freq: '3.15kHz', value: 0, freqValue: 3150 },
                { freq: '5kHz', value: 0, freqValue: 5000 },
                { freq: '8kHz', value: 0, freqValue: 8000 },
                { freq: '12.5kHz', value: 0, freqValue: 12500 },
                { freq: '16kHz', value: 0, freqValue: 16000 },
                { freq: '18kHz', value: 0, freqValue: 18000 },
                { freq: '20kHz', type: 'highshelf', value: 0, freqValue: 20000 }
            ];
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø±Ø§Ø¦Ø­ Ø§Ù„Ù…Ø¹Ø§Ø¯Ù„
            eqBands.forEach((band, index) => {
                const bandElement = document.createElement('div');
                bandElement.className = 'eq-band';
                
                bandElement.innerHTML = `
                    <input type="range" class="eq-slider" 
                           min="-12" max="12" value="${band.value}" 
                           data-index="${index}"
                           orient="vertical">
                    <div class="eq-freq">${band.freq}</div>
                    <div class="eq-value" id="eqValue${index}">${band.value}dB</div>
                `;
                
                eqBandsContainer.appendChild(bandElement);
                
                const slider = bandElement.querySelector('.eq-slider');
                slider.addEventListener('input', function() {
                    const value = this.value;
                    document.getElementById(`eqValue${index}`).textContent = `${value}dB`;
                    updateEQ(index, parseFloat(value));
                });
            });
            
            function updateEQ(index, gainValue) {
                if (filters[index]) {
                    filters[index].gain.value = gainValue;
                }
                eqBands[index].value = gainValue;
            }
            
            // Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¨ØµØ±ÙŠ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ - Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ù…Ø¹Ø¯Ù„
            function initRealVisualizer() {
                if (!analyser) {
                    console.log("Ø§Ù„Ù…Ø­Ù„Ù„ ØºÙŠØ± Ø¬Ø§Ù‡Ø² Ø¨Ø¹Ø¯");
                    return;
                }
                
                const bufferLength = analyser.frequencyBinCount;
                const dataArray = new Uint8Array(bufferLength);
                
                // ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø²Ø§Ù„Ø© Ø£ÙŠ Ù…Ø¤Ø´Ø± Ø¨ØµØ±ÙŠ Ø³Ø§Ø¨Ù‚
                visualizer.innerHTML = '';
                bars = [];
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø£Ø´Ø±Ø·Ø© Ø¬Ø¯ÙŠØ¯Ø© - Ø²ÙŠØ§Ø¯Ø© Ø§Ù„Ø¹Ø¯Ø¯ Ù„ÙŠØªÙ†Ø§Ø³Ø¨ Ù…Ø¹ Ø§Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©
                for (let i = 0; i < 40; i++) {
                    const bar = document.createElement('div');
                    bar.className = 'bar';
                    bar.style.height = '5px';
                    visualizer.appendChild(bar);
                    bars.push(bar);
                }
                
                function updateVisualizer() {
                    if (!analyser) {
                        requestAnimationFrame(updateVisualizer);
                        return;
                    }
                    
                    try {
                        analyser.getByteFrequencyData(dataArray);
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø´Ø±Ø·Ø© Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
                        for (let i = 0; i < bars.length; i++) {
                            // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹ÙŠÙ†Ø§Øª Ù…Ø®ØªÙ„ÙØ© Ù…Ù† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙˆØ²ÙŠØ¹ Ø£ÙØ¶Ù„
                            const valueIndex = Math.floor((i / bars.length) * bufferLength * 0.8);
                            const value = dataArray[valueIndex] || dataArray[i] || 0;
                            const height = (value / 255) * 70 + 5;
                            
                            bars[i].style.height = `${height}px`;
                            
                            // ØªØºÙŠÙŠØ± Ø§Ù„Ù„ÙˆÙ† Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø´Ø¯Ø© Ø§Ù„ØµÙˆØª
                            if (height > 40) {
                                bars[i].style.background = 'linear-gradient(to top, #00cc00, #66ff66)';
                            } else if (height > 25) {
                                bars[i].style.background = 'linear-gradient(to top, #006400, #00cc00)';
                            } else {
                                bars[i].style.background = 'linear-gradient(to top, #004d00, #006400)';
                            }
                        }
                        
                        // ØªØ­Ø¯ÙŠØ« Ù…Ø¤Ø´Ø± Ø§Ù„Ø¨Ø§Ø³ Ø¨Ù†Ø§Ø¡ Ø¹Ù„Ù‰ Ø§Ù„ØªØ±Ø¯Ø¯Ø§Øª Ø§Ù„Ù…Ù†Ø®ÙØ¶Ø©
                        const bassValue = (dataArray[0] + dataArray[1] + dataArray[2]) / 3;
                        bassLevel.style.width = `${(bassValue / 255) * 100}%`;
                        
                    } catch (error) {
                        console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¨ØµØ±ÙŠ:", error);
                    }
                    
                    requestAnimationFrame(updateVisualizer);
                }
                
                updateVisualizer();
            }
            
            // Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø© Ù„Ù„Ù…Ø¹Ø§Ø¯Ù„ - ØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ Ù„Ù€ 18 Ù†Ø·Ø§Ù‚ Ù…Ø¹ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù‡Ø§Ø±Ø¯Ø³ØªØ§ÙŠÙ„
            const eqPresets = {
                flat: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
                bass: [6, 6, 4, 3, 2, 1, 0, -1, -1, -1, -1, 0, 0, 0, 0, 0, 0, 0],
                vocal: [-2, -1, 0, 1, 2, 3, 3, 3, 2, 1, 0, -1, -1, -1, -1, -2, -2, -2],
                acoustic: [2, 2, 1, 0, 1, 2, 2, 2, 1, 0, 1, 2, 2, 1, 1, 2, 2, 2],
                rock: [4, 4, 3, 2, 0, -1, 1, 2, 3, 3, 4, 3, 3, 2, 2, 1, 1, 1],
                jazz: [2, 2, 1, 0, 1, 2, 2, 2, 1, 0, 1, 2, 2, 1, 1, 2, 2, 2],
                classical: [0, 0, 0, 0, 0, 1, 2, 2, 2, 2, 2, 1, 1, 0, 0, 0, 0, 0],
                electronic: [5, 5, 3, 1, -2, -1, 0, 1, 2, 3, 3, 2, 2, 1, 1, 2, 2, 2],
                hardstyle: [8, 8, 6, 4, 2, 0, -2, -4, -2, 0, 2, 4, 6, 8, 8, 6, 4, 2]
            };
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ù…Ø³Ø¨Ù‚Ø©
            document.querySelectorAll('.preset-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const preset = this.dataset.preset;
                    
                    document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    
                    if (eqPresets[preset]) {
                        eqPresets[preset].forEach((value, index) => {
                            const slider = document.querySelector(`.eq-slider[data-index="${index}"]`);
                            if (slider) {
                                slider.value = value;
                                updateEQ(index, value);
                                document.getElementById(`eqValue${index}`).textContent = `${value}dB`;
                            }
                        });
                    }
                });
            });
            
            // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¬ÙˆØ¯Ø©
            audioQuality.addEventListener('change', function() {
                if (isHighQualityEnabled) {
                    initHighQualityAudio();
                }
            });
            
            enableCompressor.addEventListener('change', function() {
                if (isHighQualityEnabled) {
                    initHighQualityAudio();
                }
            });
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø³Ø±Ø¹Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
            const playbackSpeed = document.getElementById('playbackSpeed');
            const speedValue = document.getElementById('speedValue');
            
            playbackSpeed.addEventListener('input', function() {
                const speed = this.value / 100;
                audio.playbackRate = speed;
                speedValue.textContent = `${this.value}%`;
            });
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØªØ¯Ø§Ø®Ù„
            const crossfade = document.getElementById('crossfade');
            const crossfadeValue = document.getElementById('crossfadeValue');
            
            crossfade.addEventListener('input', function() {
                crossfadeValue.textContent = `${this.value} Ø«Ø§Ù†ÙŠØ©`;
            });
            
            // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµØ¯Ù‰
            const reverb = document.getElementById('reverb');
            const reverbValue = document.getElementById('reverbValue');
            
            reverb.addEventListener('input', function() {
                const value = this.value / 100;
                reverbValue.textContent = `${this.value}%`;
                
                if (reverbGain && dryGain) {
                    reverbGain.gain.value = value;
                    // ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØª Ø§Ù„Ø¬Ø§Ù Ø¹Ù†Ø¯ Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØµØ¯Ù‰ Ù„Ù„Ø­ÙØ§Ø¸ Ø¹Ù„Ù‰ Ø§Ù„ØªÙˆØ§Ø²Ù†
                    dryGain.gain.value = 1 - (value * 0.3);
                }
            });
            
            // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªÙƒØ±Ø§Ø± A-B
            let pointA = 0;
            let pointB = 0;
            let isABRepeat = false;
            
            document.getElementById('setPointA').addEventListener('click', function() {
                pointA = audio.currentTime;
                alert(`ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù‚Ø·Ø© A Ø¹Ù†Ø¯: ${formatTime(pointA)}`);
            });
            
            document.getElementById('setPointB').addEventListener('click', function() {
                pointB = audio.currentTime;
                alert(`ØªÙ… ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù†Ù‚Ø·Ø© B Ø¹Ù†Ø¯: ${formatTime(pointB)}`);
            });
            
            document.getElementById('toggleABRepeat').addEventListener('click', function() {
                isABRepeat = !isABRepeat;
                this.classList.toggle('active', isABRepeat);
                
                if (isABRepeat) {
                    this.textContent = 'Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªÙƒØ±Ø§Ø±';
                } else {
                    this.textContent = 'ØªØ´ØºÙŠÙ„ Ø§Ù„ØªÙƒØ±Ø§Ø±';
                }
            });
            
            // Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©
            let songs = [];
            let currentSongIndex = 0;
            let isPlaying = false;
            let isRepeating = false;
            let isShuffling = false;
            let isCameraRotating = false;
            let isBoosted = false;
            let isAlbumRotating = false;
            let originalVolume = 0.7;
            let bars = [];
            
            // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØºØ§Ù†ÙŠ
            function updateSongsCount() {
                songsCount.textContent = `Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØºØ§Ù†ÙŠ: ${songs.length}`;
            }
            
            // Ø¨Ø¯Ø¡ Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ØºÙ„Ø§Ù
            function startAlbumRotation() {
                if (!isAlbumRotating && !isPowerSaveMode) {
                    albumArtContainer.classList.add('rotating');
                    isAlbumRotating = true;
                }
            }
            
            // Ø¥ÙŠÙ‚Ø§Ù Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ØºÙ„Ø§Ù
            function stopAlbumRotation() {
                if (isAlbumRotating) {
                    albumArtContainer.classList.remove('rotating');
                    isAlbumRotating = false;
                }
            }
            
            // Ø¥Ø¶Ø§ÙØ© Ù…Ø³ØªÙ…Ø¹ Ø­Ø¯Ø« Ù„Ù„Ø²Ø± Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ù„Ø¶Ù…Ø§Ù† ØªÙ‡ÙŠØ¦Ø© AudioContext
            playPauseBtn.addEventListener('click', async function() {
                if (!isAudioContextInitialized && songs.length > 0) {
                    try {
                        await initHighQualityAudio();
                        isAudioContextInitialized = true;
                    } catch (error) {
                        console.log("Ø®Ø·Ø£ ÙÙŠ ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØµÙˆØª Ø§Ù„Ù…ØªÙ‚Ø¯Ù…:", error);
                    }
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« ÙˆØ¸ÙŠÙØ© ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…ÙˆØ³ÙŠÙ‚Ù‰ Ù„Ø¶Ù…Ø§Ù† ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¨ØµØ±ÙŠ
            playPauseBtn.onclick = async function() {
                if (songs.length === 0) {
                    alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¶Ø§ÙØ© Ø£ØºÙ†ÙŠØ© Ø£ÙˆÙ„Ø§Ù‹');
                    return;
                }
                
                if (isPlaying) {
                    audio.pause();
                    playPauseBtn.innerHTML = '<i>â–¶ï¸</i>';
                    playPauseBtn.classList.remove('active-glow');
                    stopAlbumRotation();
                } else {
                    // ØªÙ‡ÙŠØ¦Ø© AudioContext Ø¹Ø§Ù„ÙŠ Ø§Ù„Ø¬ÙˆØ¯Ø© Ø¹Ù†Ø¯ Ø£ÙˆÙ„ ØªØ´ØºÙŠÙ„
                    if (!isHighQualityEnabled) {
                        await initHighQualityAudio();
                    }
                    
                    // ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† AudioContext ÙŠØ¹Ù…Ù„
                    if (audioContext && audioContext.state === 'suspended') {
                        await audioContext.resume();
                    }
                    
                    audio.play().catch(e => console.log("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„:", e));
                    playPauseBtn.innerHTML = '<i>â¸ï¸</i>';
                    playPauseBtn.classList.add('active-glow');
                    startAlbumRotation();
                    
                    // Ø¨Ø¯Ø¡ Ø§Ù„Ù…Ø¤Ø´Ø± Ø§Ù„Ø¨ØµØ±ÙŠ Ø¨Ø¹Ø¯ ØªØ£ÙƒÙŠØ¯ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª
                    setTimeout(() => {
                        if (!bars || bars.length === 0) {
                            initRealVisualizer();
                        }
                    }, 300);
                }
                isPlaying = !isPlaying;
            };
            
            // Ø§Ù„ØªÙƒØ±Ø§Ø±
            repeatBtn.addEventListener('click', function() {
                isRepeating = !isRepeating;
                repeatBtn.classList.toggle('active', isRepeating);
                if (isRepeating) {
                    repeatBtn.classList.add('active-glow');
                } else {
                    repeatBtn.classList.remove('active-glow');
                }
            });
            
            // Ø§Ù„Ø¹Ø´ÙˆØ§Ø¦ÙŠ
            shuffleBtn.addEventListener('click', function() {
                isShuffling = !isShuffling;
                shuffleBtn.classList.toggle('active', isShuffling);
                if (isShuffling) {
                    shuffleBtn.classList.add('active-glow');
                } else {
                    shuffleBtn.classList.remove('active-glow');
                }
            });
            
            // Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø³Ø±ÙŠØ¹
            progressBar.addEventListener('click', function(e) {
                if (songs.length === 0 || isNaN(audio.duration)) return;
                
                const progressWidth = this.clientWidth;
                const clickedOffsetX = e.offsetX;
                const songDuration = audio.duration;
                
                audio.currentTime = (clickedOffsetX / progressWidth) * songDuration;
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
            audio.addEventListener('timeupdate', function() {
                if (songs.length === 0 || isNaN(audio.duration)) return;
                
                const currentTime = audio.currentTime;
                const duration = audio.duration;
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
                const progressPercent = (currentTime / duration) * 100;
                progress.style.width = `${progressPercent}%`;
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„ÙˆÙ‚Øª
                currentTimeEl.textContent = formatTime(currentTime);
                
                // Ø¥Ø°Ø§ Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø£ØºÙ†ÙŠØ©
                if (currentTime >= duration - 0.5) {
                    if (isRepeating) {
                        audio.currentTime = 0;
                        audio.play();
                    } else {
                        playNextSong();
                    }
                }
                
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØªÙƒØ±Ø§Ø± A-B
                if (isABRepeat && audio.currentTime >= pointB && pointB > pointA) {
                    audio.currentTime = pointA;
                }
            });
            
            // Ø¹Ù†Ø¯Ù…Ø§ ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£ØºÙ†ÙŠØ©
            audio.addEventListener('loadedmetadata', function() {
                if (!isNaN(audio.duration)) {
                    durationEl.textContent = formatTime(audio.duration);
                }
            });
            
            // Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„ØµÙˆØª
            volumeSlider.addEventListener('click', function(e) {
                const volumeWidth = this.clientWidth;
                const clickedOffsetX = e.offsetX;
                const volumeLevel = clickedOffsetX / volumeWidth;
                
                audio.volume = volumeLevel;
                originalVolume = volumeLevel;
                volumeProgress.style.width = `${volumeLevel * 100}%`;
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø­Ø³Ù†
                volumeEnhancementSlider.value = volumeLevel * 100;
                currentVolume = volumeLevel;
                applyBoost();
            });
            
            // Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ù„ÙØ§Øª
            fileInput.addEventListener('change', async function(e) {
                const files = e.target.files;
                if (files.length === 0) return;
                
                // Ù…Ø³Ø­ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª ÙØ§Ø±ØºØ©
                if (songs.length === 0) {
                    playlist.innerHTML = '';
                }
                
                const startIndex = songs.length;
                
                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    
                    // ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø¬Ù… Ø§Ù„Ù…Ù„Ù
                    if (file.size > 50 * 1024 * 1024) {
                        showPalaceStatus('Ø§Ù„Ù…Ù„Ù ÙƒØ¨ÙŠØ± Ø¬Ø¯Ø§Ù‹ (Ø§Ù„Ø­Ø¯ 50MB)', 'error');
                        continue;
                    }
                    
                    const url = URL.createObjectURL(file);
                    
                    songs.push({
                        title: file.name.replace(/\.[^/.]+$/, ""), // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø§Ù…ØªØ¯Ø§Ø¯
                        artist: "ÙÙ†Ø§Ù† ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ",
                        src: url,
                        file: file,
                        cover: "" // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØµÙˆØ±Ø© ØºÙ„Ø§Ù Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù…ØªÙˆÙØ±Ø©
                    });
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø£ØºÙ†ÙŠØ© Ø¥Ù„Ù‰ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
                    const playlistItem = document.createElement('div');
                    playlistItem.className = 'playlist-item';
                    playlistItem.innerHTML = `
                        <i>ğŸµ</i>
                        <span>${file.name.replace(/\.[^/.]+$/, "")}</span>
                    `;
                    
                    const songIndex = startIndex + i;
                    playlistItem.addEventListener('click', async function() {
                        currentSongIndex = songIndex;
                        await loadSong(currentSongIndex);
                        audio.play().catch(e => console.log("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„:", e));
                        isPlaying = true;
                        playPauseBtn.innerHTML = '<i>â¸ï¸</i>';
                        playPauseBtn.classList.add('active-glow');
                        startAlbumRotation();
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù†Ø´Ø· ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
                        document.querySelectorAll('.playlist-item').forEach(item => {
                            item.classList.remove('active');
                        });
                        playlistItem.classList.add('active');
                    });
                    
                    playlist.appendChild(playlistItem);
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØºØ§Ù†ÙŠ
                updateSongsCount();
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ø°Ù‡ Ø£ÙˆÙ„ Ø£ØºÙ†ÙŠØ© ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡Ø§ØŒ Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹
                if (songs.length === files.length) {
                    currentSongIndex = 0;
                    await loadSong(currentSongIndex);
                    if (playlist.children.length > 0) {
                        playlist.children[0].classList.add('active');
                    }
                }
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ù„Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ø®ØªÙŠØ§Ø± Ù†ÙØ³ Ø§Ù„Ù…Ù„ÙØ§Øª Ù…Ø±Ø© Ø£Ø®Ø±Ù‰
                fileInput.value = '';
            });
            
            // Ø§Ø®ØªÙŠØ§Ø± ØµÙˆØ±Ø© Ø§Ù„ØºÙ„Ø§Ù
            imageInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const customAlbumImage = e.target.result;
                    albumImage.src = customAlbumImage;
                    
                    // Ø­ÙØ¸ Ø§Ù„ØµÙˆØ±Ø© Ù„Ù„Ø£ØºÙ†ÙŠØ© Ø§Ù„Ø­Ø§Ù„ÙŠØ© Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ù‡Ù†Ø§Ùƒ Ø£ØºÙ†ÙŠØ© Ù†Ø´Ø·Ø©
                    if (songs.length > 0 && currentSongIndex < songs.length) {
                        songs[currentSongIndex].cover = customAlbumImage;
                    }
                };
                reader.readAsDataURL(file);
            });
            
            // Ø§Ù„Ø£ØºÙ†ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
            nextBtn.addEventListener('click', playNextSong);
            
            // Ø§Ù„Ø£ØºÙ†ÙŠØ© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø©
            prevBtn.addEventListener('click', function() {
                if (songs.length === 0) return;
                
                currentSongIndex--;
                if (currentSongIndex < 0) {
                    currentSongIndex = songs.length - 1;
                }
                
                loadSong(currentSongIndex);
                if (isPlaying) {
                    audio.play().catch(e => console.log("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„:", e));
                }
                
                updatePlaylistActive();
            });
            
            // ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£ØºÙ†ÙŠØ© Ø§Ù„ØªØ§Ù„ÙŠØ©
            function playNextSong() {
                if (songs.length === 0) return;
                
                if (isShuffling) {
                    let newIndex;
                    do {
                        newIndex = Math.floor(Math.random() * songs.length);
                    } while (newIndex === currentSongIndex && songs.length > 1);
                    currentSongIndex = newIndex;
                } else {
                    currentSongIndex++;
                    if (currentSongIndex >= songs.length) {
                        currentSongIndex = 0;
                    }
                }
                
                loadSong(currentSongIndex);
                if (isPlaying) {
                    audio.play().catch(e => console.log("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„:", e));
                }
                
                updatePlaylistActive();
            }
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£ØºÙ†ÙŠØ©
            async function loadSong(index) {
                if (index < 0 || index >= songs.length) return;
                
                const song = songs[index];
                audio.src = song.src;
                songTitle.textContent = song.title;
                songArtist.textContent = song.artist;
                
                if (song.cover) {
                    albumImage.src = song.cover;
                } else {
                    // ØµÙˆØ±Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¥Ø°Ø§ Ù„Ù… ØªÙƒÙ† Ù‡Ù†Ø§Ùƒ ØµÙˆØ±Ø© ØºÙ„Ø§Ù
                    albumImage.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='240' height='240' viewBox='0 0 240 240'%3E%3Crect width='240' height='240' fill='%23006400'/%3E%3Ctext x='50%25' y='50%25' dominant-baseline='middle' text-anchor='middle' font-family='Arial' font-size='24' fill='%23FFD700'%3E%D8%BA%D9%84%D8%A7%D9%81%3C/text%3E%3C/svg%3E";
                }
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù…
                progress.style.width = '0%';
                currentTimeEl.textContent = '0:00';
                durationEl.textContent = '0:00';
                
                // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø£ØµÙ„ÙŠ Ù„Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ±
                if (song.file && audioContext) {
                    try {
                        const arrayBuffer = await song.file.arrayBuffer();
                        originalAudioBuffer = await audioContext.decodeAudioData(arrayBuffer);
                        processedAudioBuffer = null; // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬
                        showPalaceStatus('Ø¬Ø§Ù‡Ø² Ù„ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚ØµØ±', 'success');
                    } catch (error) {
                        console.log("Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©:", error);
                    }
                }
            }
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù†Ø´Ø· ÙÙŠ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„
            function updatePlaylistActive() {
                document.querySelectorAll('.playlist-item').forEach((item, index) => {
                    if (index === currentSongIndex) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                });
            }
            
            // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙˆÙ‚Øª
            function formatTime(seconds) {
                if (isNaN(seconds)) return "0:00";
                
                const minutes = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
            }
            
            // ØªØ¯ÙˆÙŠØ± Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ - Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø³Ù†
            let rotationAngle = 0;
            let cameraRotationId = null;
            
            cameraToggle.addEventListener('click', function() {
                if (isPowerSaveMode) {
                    alert("ÙˆØ¶Ø¹ ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø© Ù…ÙØ¹Ù„. Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ´ØºÙŠÙ„ Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§.");
                    return;
                }
                
                isCameraRotating = !isCameraRotating;
                cameraToggle.classList.toggle('active', isCameraRotating);
                
                if (isCameraRotating) {
                    cameraToggle.textContent = 'Ø¥ÙŠÙ‚Ø§Ù Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§';
                    startCameraRotation();
                } else {
                    cameraToggle.textContent = 'ØªØ´ØºÙŠÙ„ Ø¯ÙˆØ±Ø§Ù† Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§';
                    stopCameraRotation();
                }
            });
            
            // ØªØ¯ÙˆÙŠØ± Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… requestAnimationFrame
            function startCameraRotation() {
                if (!isCameraRotating) return;
                
                rotationAngle += 0.5;
                document.getElementById('playerSection').style.transform = `rotateY(${rotationAngle}deg) rotateX(5deg)`;
                
                cameraRotationId = requestAnimationFrame(startCameraRotation);
            }
            
            function stopCameraRotation() {
                if (cameraRotationId) {
                    cancelAnimationFrame(cameraRotationId);
                    cameraRotationId = null;
                }
                // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØªØ­ÙˆÙŠÙ„ Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø£ØµÙ„ÙŠØ©
                document.getElementById('playerSection').style.transform = 'none';
                rotationAngle = 0;
            }
            
            // ØªØ¶Ø®ÙŠÙ… Ø§Ù„ØµÙˆØª
            boostBtn.addEventListener('click', function() {
                if (isBoosted) {
                    // Ø¥Ù„ØºØ§Ø¡ Ø§Ù„ØªØ¶Ø®ÙŠÙ…
                    audio.volume = originalVolume;
                    boostBtn.classList.remove('active');
                    isBoosted = false;
                } else {
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ØªØ¶Ø®ÙŠÙ…
                    audio.volume = Math.min(1.0, originalVolume * 1.8);
                    boostBtn.classList.add('active');
                    isBoosted = true;
                }
            });
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙˆØªÙŠØ© Ø§Ù„Ù…Ø³Ø¨Ù‚Ø©
            audioPresets.forEach(preset => {
                preset.addEventListener('click', function() {
                    const presetType = this.dataset.preset;
                    
                    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ù†Ø´Ø· Ù…Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                    audioPresets.forEach(btn => btn.classList.remove('active'));
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù†Ø´Ø· Ù„Ù„Ø²Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯
                    this.classList.add('active');
                    
                    // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ù†ÙˆØ¹
                    switch(presetType) {
                        case 'bass':
                            // ØªØ·Ø¨ÙŠÙ‚ ØªØ¶Ø®ÙŠÙ… Ù„Ù„Ø¨Ø§Ø³
                            audio.volume = Math.min(1.0, originalVolume * 1.3);
                            break;
                        case 'treble':
                            // ØªØ·Ø¨ÙŠÙ‚ ØªØ¶Ø®ÙŠÙ… Ù„Ù„Ø­Ø¯Ø©
                            audio.volume = Math.min(1.0, originalVolume * 1.1);
                            break;
                        case 'palace':
                            // ØªÙØ¹ÙŠÙ„ ÙˆØ¶Ø¹ Ø§Ù„Ù‚ØµØ±
                            if (!palaceEffectEnabled) {
                                palaceToggleBtn.click();
                            }
                            break;
                        case 'normal':
                        default:
                            audio.volume = originalVolume;
                            break;
                    }
                });
            });
            
            // ØªØ­Ø³ÙŠÙ† Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø¹Ù†Ø¯ Ø¥ÙˆÙ‚Ù Ø§Ù„ØªØ´ØºÙŠÙ„
            audio.addEventListener('pause', function() {
                if (analyser && isHighQualityEnabled) {
                    // ØªÙ‚Ù„ÙŠÙ„ Ù…Ø¹Ø¯Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø¯ Ø§Ù„ØªÙˆÙ‚Ù
                    setTimeout(() => {
                        if (!isPlaying) {
                            // ÙŠÙ…ÙƒÙ† Ø¥Ø¶Ø§ÙØ© ØªØ­Ø³ÙŠÙ†Ø§Øª Ø£Ø¯Ø§Ø¡ Ø¥Ø¶Ø§ÙÙŠØ© Ù‡Ù†Ø§
                        }
                    }, 1000);
                }
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø§Ø®ØªØµØ§Ø±Ø§Øª Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙØ§ØªÙŠØ­
            document.addEventListener('keydown', function(e) {
                // Ù…Ù†Ø¹ ØªÙ†ÙÙŠØ° Ø§Ù„Ø§Ø®ØªØµØ§Ø±Ø§Øª Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙŠÙƒØªØ¨ ÙÙŠ Ø­Ù‚Ù„ Ø¥Ø¯Ø®Ø§Ù„
                if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') {
                    return;
                }
                
                switch(e.key) {
                    case ' ':
                        e.preventDefault();
                        playPauseBtn.click();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        nextBtn.click();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        prevBtn.click();
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        // Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØµÙˆØª Ø¨Ù†Ø³Ø¨Ø© 5%
                        const newVolumeUp = Math.min(audio.volume + 0.05, 1);
                        audio.volume = newVolumeUp;
                        originalVolume = newVolumeUp;
                        volumeProgress.style.width = `${newVolumeUp * 100}%`;
                        volumeEnhancementSlider.value = newVolumeUp * 100;
                        currentVolume = newVolumeUp;
                        applyBoost();
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        // ØªÙ‚Ù„ÙŠÙ„ Ø§Ù„ØµÙˆØª Ø¨Ù†Ø³Ø¨Ø© 5%
                        const newVolumeDown = Math.max(audio.volume - 0.05, 0);
                        audio.volume = newVolumeDown;
                        originalVolume = newVolumeDown;
                        volumeProgress.style.width = `${newVolumeDown * 100}%`;
                        volumeEnhancementSlider.value = newVolumeDown * 100;
                        currentVolume = newVolumeDown;
                        applyBoost();
                        break;
                    case 'r':
                    case 'R':
                        e.preventDefault();
                        repeatBtn.click();
                        break;
                    case 's':
                    case 'S':
                        e.preventDefault();
                        shuffleBtn.click();
                        break;
                    case 'b':
                    case 'B':
                        e.preventDefault();
                        boostBtn.click();
                        break;
                    case 'c':
                    case 'C':
                        e.preventDefault();
                        cameraToggle.click();
                        break;
                    case 'p':
                    case 'P':
                        e.preventDefault();
                        powerSaveBtn.click();
                        break;
                    case 't':
                    case 'T':
                        e.preventDefault();
                        palaceToggleBtn.click();
                        break;
                    case 'h':
                    case 'H':
                        e.preventDefault();
                        shortcutsModal.style.display = shortcutsModal.style.display === 'flex' ? 'none' : 'flex';
                        break;
                    case 'F11':
                        e.preventDefault();
                        fullscreenBtn.click();
                        break;
                }
            });
            
            // ============================================
            // ÙˆØ¸Ø§Ø¦Ù Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ
            // ============================================
            
            // ØªØ¨Ø¯ÙŠÙ„ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ
            palaceToggleBtn.addEventListener('click', function() {
                if (isPowerSaveMode) {
                    alert("ÙˆØ¶Ø¹ ØªÙˆÙÙŠØ± Ø§Ù„Ø·Ø§Ù‚Ø© Ù…ÙØ¹Ù„. Ù„Ø§ ÙŠÙ…ÙƒÙ† ØªØ´ØºÙŠÙ„ Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ±.");
                    return;
                }
                
                palaceEffectEnabled = !palaceEffectEnabled;
                palaceToggleBtn.classList.toggle('active', palaceEffectEnabled);
                palaceEffectControls.style.display = palaceEffectEnabled ? 'block' : 'none';
                
                if (palaceEffectEnabled) {
                    palaceToggleBtn.textContent = 'Ø¥ÙŠÙ‚Ø§Ù Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ±';
                    showPalaceStatus('Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ Ù…ÙØ¹Ù„', 'info');
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ… Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
                    updatePalaceValues();
                } else {
                    palaceToggleBtn.textContent = 'Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ± Ø§Ù„ØµÙˆØªÙŠ';
                    palaceStatus.style.display = 'none';
                    
                    // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØµÙˆØª Ø§Ù„Ø£ØµÙ„ÙŠ
                    if (songs.length > 0 && currentSongIndex < songs.length) {
                        audio.src = songs[currentSongIndex].src;
                    }
                }
            });
            
            // ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ… Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ±
            function updatePalaceValues() {
                palaceParams.size = palaceSize.value / 100;
                palaceParams.brilliance = palaceBrilliance.value / 100;
                palaceParams.marble = palaceMarble.value / 100;
                palaceParams.air = palaceAir.value / 100;
                
                palaceSizeValue.textContent = palaceSize.value + '%';
                palaceBrillianceValue.textContent = palaceBrilliance.value + '%';
                palaceMarbleValue.textContent = palaceMarble.value + '%';
                palaceAirValue.textContent = palaceAir.value + '%';
            }
            
            // Ø£Ø­Ø¯Ø§Ø« ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙŠÙ…
            palaceSize.addEventListener('input', updatePalaceValues);
            palaceBrilliance.addEventListener('input', updatePalaceValues);
            palaceMarble.addEventListener('input', updatePalaceValues);
            palaceAir.addEventListener('input', updatePalaceValues);
            
            // ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚ØµØ±
            applyPalaceEffectBtn.addEventListener('click', async function() {
                if (!originalAudioBuffer || isProcessingPalaceEffect) return;
                
                isProcessingPalaceEffect = true;
                processingIndicator.style.display = 'block';
                processingProgress.style.width = '10%';
                
                try {
                    showPalaceStatus('Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØª...', 'info');
                    
                    // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ù„Ù…Ø§Øª
                    updatePalaceValues();
                    
                    processingProgress.style.width = '30%';
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ AudioBuffer Ù„Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
                    const sampleRate = originalAudioBuffer.sampleRate;
                    const length = originalAudioBuffer.length;
                    const numberOfChannels = originalAudioBuffer.numberOfChannels;
                    
                    // Ù…Ø¹Ø§Ù„Ø¬Ø© ÙƒÙ„ Ù‚Ù†Ø§Ø©
                    const processedChannels = [];
                    
                    for (let channel = 0; channel < numberOfChannels; channel++) {
                        const originalData = originalAudioBuffer.getChannelData(channel);
                        const processedData = new Float32Array(length);
                        
                        processingProgress.style.width = 30 + (channel * 20) + '%';
                        
                        // ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚ØµØ±
                        applyPalaceEffect(originalData, processedData, palaceParams, sampleRate);
                        
                        processedChannels.push(processedData);
                    }
                    
                    processingProgress.style.width = '80%';
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ AudioBuffer Ø¬Ø¯ÙŠØ¯
                    processedAudioBuffer = audioContext.createBuffer(
                        numberOfChannels,
                        length,
                        sampleRate
                    );
                    
                    for (let channel = 0; channel < numberOfChannels; channel++) {
                        processedAudioBuffer.getChannelData(channel).set(processedChannels[channel]);
                    }
                    
                    processingProgress.style.width = '100%';
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ù„Ù„ØµÙˆØª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬
                    const blob = audioBufferToWav(processedAudioBuffer);
                    const url = URL.createObjectURL(blob);
                    
                    // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„ØµÙˆØª Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬
                    const wasPlaying = isPlaying;
                    if (wasPlaying) {
                        audio.pause();
                    }
                    
                    audio.src = url;
                    
                    if (wasPlaying) {
                        setTimeout(() => {
                            audio.play().catch(e => console.log("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„ØªØ´ØºÙŠÙ„:", e));
                        }, 100);
                    }
                    
                    showPalaceStatus('ØªÙ…Øª Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„ØµÙˆØª Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    
                    // ØªÙ…ÙƒÙŠÙ† Ø²Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
                    downloadProcessedBtn.disabled = false;
                    
                } catch (error) {
                    showPalaceStatus(`Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©: ${error.message}`, 'error');
                    console.error("Ø®Ø·Ø£ ÙÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù‚ØµØ±:", error);
                } finally {
                    isProcessingPalaceEffect = false;
                    processingIndicator.style.display = 'none';
                    processingProgress.style.width = '0%';
                }
            });
            
            // ØªØ·Ø¨ÙŠÙ‚ ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚ØµØ± (Ø§Ù„Ø®ÙˆØ§Ø±Ø²Ù…ÙŠØ© Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ©)
            function applyPalaceEffect(input, output, params, sampleRate) {
                const length = input.length;
                
                // 1. ØªØ·Ø¨ÙŠØ¹
                let max = 0;
                for (let i = 0; i < length; i++) {
                    max = Math.max(max, Math.abs(input[i]));
                }
                if (max > 0) {
                    for (let i = 0; i < length; i++) {
                        input[i] /= max;
                    }
                }
                
                // 2. ØªØ£Ø«ÙŠØ± Ø§Ù„Ø±Ø®Ø§Ù…ÙŠØ©
                const marbleLength = Math.floor(sampleRate * 0.002);
                for (let i = 0; i < length; i++) {
                    let marbleEffect = 0;
                    for (let j = 0; j < 3; j++) {
                        const delay = Math.floor(sampleRate / (110 + j * 55));
                        if (i >= delay) {
                            marbleEffect += input[i - delay] * (0.4 - j * 0.1);
                        }
                    }
                    output[i] = input[i] + marbleEffect * params.marble;
                }
                
                // 3. ØªØ¹Ø²ÙŠØ² Ø§Ù„ØªØ±ÙŠØ¨Ù„
                const brillianceGain = params.brilliance * 2;
                const airCutoff = 8000 + params.air * 7000;
                
                // Ù…Ø­Ø§ÙƒØ§Ø© ØªØ¹Ø²ÙŠØ² Ø§Ù„ØªØ±Ø¯Ø¯Ø§Øª Ø§Ù„Ø¹Ø§Ù„ÙŠØ©
                const prevSamples = new Array(3).fill(0);
                for (let i = 0; i < length; i++) {
                    const sample = output[i];
                    
                    // Ù…Ø±Ø´Ø­ ØªÙ…Ø±ÙŠØ± Ø¹Ø§Ù„ÙŠ Ø¨Ø³ÙŠØ·
                    const highPass = sample - prevSamples[0] * 0.5;
                    prevSamples[0] = sample;
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªØ±ÙŠØ¨Ù„
                    output[i] = output[i] + highPass * brillianceGain * 0.3;
                }
                
                // 4. ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚ØµØ± (Reverb Ø¨Ø³ÙŠØ·)
                const earlyDelays = [
                    Math.floor(sampleRate * 0.002),
                    Math.floor(sampleRate * 0.005),
                    Math.floor(sampleRate * 0.008),
                    Math.floor(sampleRate * 0.012)
                ];
                
                const decay = 0.7;
                const sizeFactor = params.size * 2;
                
                for (let i = 0; i < length; i++) {
                    let reverb = 0;
                    
                    // Ø§Ù„Ø§Ù†Ø¹ÙƒØ§Ø³Ø§Øª Ø§Ù„Ù…Ø¨ÙƒØ±Ø©
                    earlyDelays.forEach((delay, idx) => {
                        if (i >= delay) {
                            reverb += output[i - delay] * (0.3 * Math.exp(-idx * 0.5));
                        }
                    });
                    
                    // Ø§Ù„Ø°ÙŠÙ„
                    for (let j = 1; j <= 6; j++) {
                        const delay = Math.floor(sampleRate * 0.015 * j * sizeFactor);
                        if (i >= delay) {
                            reverb += output[i - delay] * (0.4 * Math.exp(-j * decay));
                        }
                    }
                    
                    output[i] = output[i] + reverb * params.size;
                }
                
                // 5. Soft Clipping Ù„Ù…Ù†Ø¹ Ø§Ù„ØªØ´ÙˆÙŠÙ‡
                for (let i = 0; i < length; i++) {
                    output[i] = Math.tanh(output[i] * 1.2);
                }
                
                // 6. ØªØ·Ø¨ÙŠØ¹ Ø§Ù„Ù†Ø§ØªØ¬
                max = 0;
                for (let i = 0; i < length; i++) {
                    max = Math.max(max, Math.abs(output[i]));
                }
                if (max > 0) {
                    for (let i = 0; i < length; i++) {
                        output[i] /= max;
                    }
                }
            }
            
            // Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† ØªØ£Ø«ÙŠØ± Ø§Ù„Ù‚ØµØ±
            resetPalaceEffectBtn.addEventListener('click', function() {
                if (songs.length > 0 && currentSongIndex < songs.length) {
                    audio.src = songs[currentSongIndex].src;
                    showPalaceStatus('ØªÙ… Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„ØµÙˆØª Ø¥Ù„Ù‰ Ø§Ù„Ø£ØµÙ„', 'info');
                    downloadProcessedBtn.disabled = true;
                    
                    palaceSize.value = 75;
                    palaceBrilliance.value = 80;
                    palaceMarble.value = 50;
                    palaceAir.value = 60;
                    updatePalaceValues();
                }
            });
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØª Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬
            downloadProcessedBtn.addEventListener('click', function() {
                if (!processedAudioBuffer) return;
                
                // ØªØ­ÙˆÙŠÙ„ AudioBuffer Ø¥Ù„Ù‰ WAV
                const wavBuffer = audioBufferToWav(processedAudioBuffer);
                const blob = new Blob([wavBuffer], { type: 'audio/wav' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `Ù‚ØµØ±_ØµÙˆØª_${Date.now()}.wav`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                
                URL.revokeObjectURL(url);
                
                showPalaceStatus('ØªÙ… Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù', 'success');
            });
            
            // ØªØ­ÙˆÙŠÙ„ AudioBuffer Ø¥Ù„Ù‰ WAV
            function audioBufferToWav(buffer) {
                const numChannels = buffer.numberOfChannels;
                const sampleRate = buffer.sampleRate;
                const length = buffer.length * numChannels * 2 + 44;
                const arrayBuffer = new ArrayBuffer(length);
                const view = new DataView(arrayBuffer);
                
                // ÙƒØªØ§Ø¨Ø© Ø±Ø£Ø³ WAV
                writeString(view, 0, 'RIFF');
                view.setUint32(4, 36 + buffer.length * numChannels * 2, true);
                writeString(view, 8, 'WAVE');
                writeString(view, 12, 'fmt ');
                view.setUint32(16, 16, true);
                view.setUint16(20, 1, true);
                view.setUint16(22, numChannels, true);
                view.setUint32(24, sampleRate, true);
                view.setUint32(28, sampleRate * numChannels * 2, true);
                view.setUint16(32, numChannels * 2, true);
                view.setUint16(34, 16, true);
                writeString(view, 36, 'data');
                view.setUint32(40, buffer.length * numChannels * 2, true);
                
                // ÙƒØªØ§Ø¨Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const offset = 44;
                for (let i = 0; i < buffer.length; i++) {
                    for (let channel = 0; channel < numChannels; channel++) {
                        const sample = Math.max(-1, Math.min(1, buffer.getChannelData(channel)[i]));
                        view.setInt16(offset + (i * numChannels + channel) * 2, 
                            sample < 0 ? sample * 0x8000 : sample * 0x7FFF, true);
                    }
                }
                
                return arrayBuffer;
            }
            
            function writeString(view, offset, string) {
                for (let i = 0; i < string.length; i++) {
                    view.setUint8(offset + i, string.charCodeAt(i));
                }
            }
            
            // Ø¹Ø±Ø¶ Ø­Ø§Ù„Ø© Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ±
            function showPalaceStatus(message, type = 'info') {
                const colors = {
                    info: '#2979ff',
                    success: '#00e676',
                    error: '#ff1744',
                    warning: '#ff9100'
                };
                
                palaceStatus.textContent = message;
                palaceStatus.style.background = colors[type] || colors.info;
                palaceStatus.style.display = 'block';
                palaceStatus.style.color = '#fff';
                
                // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
                setTimeout(() => {
                    palaceStatus.style.display = 'none';
                }, 5000);
            }
            
            // ØªÙ‡ÙŠØ¦Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ø£ØºØ§Ù†ÙŠ
            updateSongsCount();
            
            // ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ÙˆÙ„ÙŠØ©
            applyBoost();
            
            // ØªØ­Ø¯ÙŠØ« Ù‚ÙŠÙ… Ù…Ø¹Ø§Ù„Ø¬ Ø§Ù„Ù‚ØµØ±
            updatePalaceValues();
            
            // Ø·Ù„Ø¨ Ø¥Ø°Ù† Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
            if ("Notification" in window && Notification.permission === "default") {
                Notification.requestPermission();
            }
        });
    </script>
</body>
</html>
